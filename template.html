<!DOCTYPE html>
<html lang="ro">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Generator Tabel-Email Quality Common Processes</title>
    <!-- Carga de Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Estilo para el mensaje de notificación */
        #copy-notification-wpn,
        #copy-notification-wp,
        #copy-notification-wo,
        #copy-notification-msl,
        #copy-notification-wps,
        #copy-notification-id, /* <-- v42.0 (Ya debería estar) */
        #copy-notification-poze,
        #copy-notification-cr,
        #copy-notification-de  { 
            transition: opacity 0.5s ease-out;
        }
        
        /* Estilo para mostrar/ocultar el formulario */
        .form-container {
            transition: opacity 0.5s ease-out, max-height 0.5s ease-out;
            max-height: 0;
            opacity: 0;
            overflow: hidden;
        }
        
        .form-container.visible {
            max-height: 15000px; /* Un valor suficientemente grande */
            opacity: 1;
            margin-top: 1.5rem; /* Agrega espacio cuando está visible */
        }

        /* v30.0: Asegura que los campos requeridos inválidos tengan un borde rojo */
        input:invalid,
        select:invalid,
        textarea:invalid {
            border-color: #ef4444; /* Rojo de Tailwind */
        }
    </style>
</head>
<body class="bg-gray-100 font-sans antialiased">

    <div class="container mx-auto max-w-4xl p-4 sm:p-8 my-10 bg-white rounded-lg shadow-2xl">

        <header class="mb-8 border-b pb-4">
            <h1 class="text-3xl font-bold text-gray-800">Generator Tabel-Email Quality Common Processes</h1>
            <p class="text-gray-600 mt-2">Selectați opțiunea dorită și Introduceți datele în formular pentru a genera tabelul formatat.</p>
        </header>

        <!-- Secciones de Botones -->
        <div id="button-sections-container" class="space-y-6 mb-10">
    
            <!-- Sección SMT Common Processes -->
            <div class="bg-blue-50 p-4 rounded-lg shadow-sm border border-blue-200">
                <h2 class="text-xl font-semibold text-blue-800 border-b border-blue-200 pb-2 mb-4">SMT Common Processes</h2>
                <div class="flex flex-wrap gap-2">
                    <button type="button" id="show-form-btn-wpn" class="bg-blue-200 text-blue-800 font-medium py-2 px-4 rounded-lg hover:bg-blue-300 transition-all text-sm">Wrong Part Number SMT</button>
                    <button type="button" id="show-form-btn-wp" class="bg-blue-200 text-blue-800 font-medium py-2 px-4 rounded-lg hover:bg-blue-300 transition-all text-sm">Wrong Process SMT</button>
                    <button type="button" id="show-form-btn-wo" class="bg-blue-200 text-blue-800 font-medium py-2 px-4 rounded-lg hover:bg-blue-300 transition-all text-sm">Wrong Orientation</button>
                    <button type="button" id="show-form-btn-msl" class="bg-blue-200 text-blue-800 font-medium py-2 px-4 rounded-lg hover:bg-blue-300 transition-all text-sm">MSL Expirat</button>
                    <button type="button" id="show-form-btn-cr" class="bg-blue-200 text-blue-800 font-medium py-2 px-4 rounded-lg hover:bg-blue-300 transition-all text-sm">Capete de Rola P/N Gresit</button>
                </div>
            </div>
    
            <!-- Sección Soldering / Conformal Common Processes -->
            <div class="bg-green-50 p-4 rounded-lg shadow-sm border border-green-200">
                <h2 class="text-xl font-semibold text-green-800 border-b border-green-200 pb-2 mb-4">Soldering / Conformal Common Processes</h2>
                <div class="flex flex-wrap gap-2">
                    <button type="button" id="show-form-btn-wps" class="bg-green-200 text-green-800 font-medium py-2 px-4 rounded-lg hover:bg-green-300 transition-all text-sm">Wrong Process Soldering</button>
                    <button type="button" id="show-form-btn-id" class="bg-green-200 text-green-800 font-medium py-2 px-4 rounded-lg hover:bg-green-300 transition-all text-sm">Insertion Defects</button>
		<button type="button" id="show-form-btn-cd" class="bg-green-200 text-green-800 font-medium py-2 px-4 rounded-lg hover:bg-green-300 transition-all text-sm">Conformal Defects</button>                
		</div>
            </div>
    
            <!-- Sección Altele -->
            <div class="bg-yellow-50 p-4 rounded-lg shadow-sm border border-yellow-200">
                <h2 class="text-xl font-semibold text-yellow-800 border-b border-yellow-200 pb-2 mb-4">Altele</h2>
                <div class="flex flex-wrap gap-2">
                    <button type="button" id="show-form-btn-poze" class="bg-yellow-200 text-yellow-800 font-medium py-2 px-4 rounded-lg hover:bg-yellow-300 transition-all text-sm">Template Poze AOI / AAD / SPI</button>
                    <button type="button" id="show-form-btn-de" class="bg-yellow-200 text-yellow-800 font-medium py-2 px-4 rounded-lg hover:bg-yellow-300 transition-all text-sm">Template Defecte Etichete</button>
                </div>
            </div>
            
        </div>
        <!-- Fin Secciones de Botones -->


        <!-- Contenedor Oculto para Formulario 1 (Wrong Part Number) -->
        <div id="form-container-wpn" class="form-container">

            <h2 class="text-2xl font-bold text-gray-800 mb-4 border-b pb-2">Formular: Wrong Part Number SMT</h2>
            <form id="data-form-wpn" class="space-y-6" novalidate>
                <!-- Sección 1: QT Technician -->
                <div>
                    <h2 class="text-xl font-semibold text-indigo-700 border-b pb-2 mb-4">Secțiunea 1: QT Technician</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4">
                        <div class="md:col-span-2">
                            <label for="wpn_qtModelPart" class="block text-sm font-medium text-gray-700">Model Part Number<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="wpn_qtModelPart" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                        <div class="md:col-span-2">
                            <label for="wpn_qtComponentPart" class="block text-sm font-medium text-gray-700">Component Part Number<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="wpn_qtComponentPart" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                        <div class="md:col-span-2">
                            <label for="wpn_qtSideAffected" class="block text-sm font-medium text-gray-700">Side Affected<span class="text-red-500 ml-1">*</span></label>
                            <select id="wpn_qtSideAffected" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                                <option value="">Selectați...</option>
                                <option value="A">Side A</option>
                                <option value="B">Side B</option>
                                <option value="A+B">Side A + Side B</option>
                            </select>
                        </div>
                        <div>
                            <label for="wpn_qtUsageSideA" class="block text-sm font-medium text-gray-700">Usage / Side (A)<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="wpn_qtUsageSideA" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                        <div>
                            <label for="wpn_qtUsageSideB" class="block text-sm font-medium text-gray-700">Usage / Side (B)<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="wpn_qtUsageSideB" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                        <div>
                            <label for="wpn_qtRefAffectedA" class="block text-sm font-medium text-gray-700">Reference Affected (A)<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="wpn_qtRefAffectedA" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                         <div>
                            <label for="wpn_qtRefAffectedB" class="block text-sm font-medium text-gray-700">Reference Affected (B)<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="wpn_qtRefAffectedB" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                        <div class="md:col-span-2">
                            <label for="wpn_qtShape" class="block text-sm font-medium text-gray-700">Shape / Marking / Value<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="wpn_qtShape" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                        <div>
                            <label for="wpn_qtLineAffected" class="block text-sm font-medium text-gray-700">Line Affected<span class="text-red-500 ml-1">*</span></label>
                            <!-- v37.0: Campo cambiado a select -->
                            <select id="wpn_qtLineAffected" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                                <option value="">Selectați...</option>
                                <option value="Linia 1 SMT (4701A)">Linia 1 SMT (4701A)</option>
                                <option value="Linia 2 SMT (4701B)">Linia 2 SMT (4701B)</option>
                                <option value="Linia 3 SMT (4701C)">Linia 3 SMT (4701C)</option>
                                <option value="Linia 4 SMT (4701D)">Linia 4 SMT (4701D)</option>
                                <option value="Linia 5 SMT (4701E)">Linia 5 SMT (4701E)</option>
                                <option value="Linia 6 SMT (4701F)">Linia 6 SMT (4701F)</option>
                                <option value="Linia 7 SMT (4701G)">Linia 7 SMT (4701G)</option>
                                <option value="Linia 10 SMT (4701J)">Linia 10 SMT (4701J)</option>
                            </select>
                        </div>
                        <div>
                            <label for="wpn_qtWoAffected" class="block text-sm font-medium text-gray-700">Work Order Affected<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="wpn_qtWoAffected" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                        <div>
                            <label for="wpn_qtWoQty" class="block text-sm font-medium text-gray-700">Work Order QTY<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="wpn_qtWoQty" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                        <div>
                            <label for="wpn_qtDateShift" class="block text-sm font-medium text-gray-700">Date / Shift<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="wpn_qtDateShift" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                    </div>
                </div>
                <!-- Sección 2: Test Inspection AOI -->
                <div>
                    <h2 class="text-xl font-semibold text-indigo-700 border-b pb-2 mb-4">Secțiunea 2: Test Inspection AOI</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4">
                        <div>
                            <label for="wpn_aoiFalseCall" class="block text-sm font-medium text-gray-700">False Call on AOI / GSF ?<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="wpn_aoiFalseCall" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                        <div>
                            <label for="wpn_aoiPhotos" class="block text-sm font-medium text-gray-700">IF YES - Link To Photos<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="wpn_aoiPhotos" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                    </div>
                </div>
                <!-- Sección 3: Test Debug - ICT / Functional Test -->
                <div>
                    <h2 class="text-xl font-semibold text-indigo-700 border-b pb-2 mb-4">Secțiunea 3: Test Debug - ICT / Functional Test</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4">
                        <div class="md:col-span-2">
                            <label for="wpn_tdCoverage" class="block text-sm font-medium text-gray-700">We have Coverage on affected References?<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="wpn_tdCoverage" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                    </div>
                </div>
                <!-- Sección 4: Line Logistics -->
                <div>
                    <h2 class="text-xl font-semibold text-blue-700 border-b pb-2 mb-4">Secțiunea 4: Line Logistics</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4">
                        <div>
                            <label for="wpn_llLicensePlate1" class="block text-sm font-medium text-gray-700">(LP) License Plate Used / Scanned (1)<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="wpn_llLicensePlate1" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                        <div>
                            <label for="wpn_llLicensePlate4" class="block text-sm font-medium text-gray-700">(LP) License Plate Used / Scanned (4)<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="wpn_llLicensePlate4" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                        <div>
                            <label for="wpn_llLicensePlate2" class="block text-sm font-medium text-gray-700">(LP) License Plate Used / Scanned (2)<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="wpn_llLicensePlate2" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                        <div>
                            <label for="wpn_llLicensePlate5" class="block text-sm font-medium text-gray-700">(LP) License Plate Used / Scanned (5)<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="wpn_llLicensePlate5" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                        <div>
                            <label for="wpn_llLicensePlate3" class="block text-sm font-medium text-gray-700">(LP) License Plate Used / Scanned (3)<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="wpn_llLicensePlate3" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                         <div>
                            <label for="wpn_llLicensePlate6" class="block text-sm font-medium text-gray-700">(LP) License Plate Used / Scanned (6)<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="wpn_llLicensePlate6" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                    </div>
                </div>
                <!-- Sección 5: Containment Production / CFT -->
                <div>
                    <h2 class="text-xl font-semibold text-yellow-600 border-b pb-2 mb-4">Secțiunea 5: Containment Production / CFT</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4">
                        <div>
                            <label for="wpn_cftCommonProcess" class="block text-sm font-medium text-gray-700">Common Process (WIP)<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="wpn_cftCommonProcess" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                        <div>
                            <label for="wpn_cftLine" class="block text-sm font-medium text-gray-700">CFT Line (MPF)<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="wpn_cftLine" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                        <div>
                            <label for="wpn_cftTotalQty" class="block text-sm font-medium text-gray-700">Total QTY Affected<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="wpn_cftTotalQty" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                        <div>
                            <label for="wpn_cftAllAffectedSN" class="block text-sm font-medium text-gray-700">All Affected (S/N) Serial Numbers Was Sent To Fix?<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="wpn_cftAllAffectedSN" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                         <div class="md:col-span-2">
                            <label for="wpn_cftContainmentChecks" class="block text-sm font-medium text-gray-700">Containment Checks<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="wpn_cftContainmentChecks" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                    </div>
                </div>
                <!-- Sección 6: Process Tech / Engineering -->
                <div>
                    <h2 class="text-xl font-semibold text-red-700 border-b pb-2 mb-4">Secțiunea 6: Process Tech / Engineering</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4">
                        <div class="md:col-span-2">
                            <label for="wpn_ptSiplaceErrors" class="block text-sm font-medium text-gray-700">Siplace Errors<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="wpn_ptSiplaceErrors" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                    </div>
                </div>
                <!-- Sección 7: Root Cause -->
                <div>
                    <h2 class="text-xl font-semibold text-gray-700 border-b pb-2 mb-4">Secțiunea 7: Root Cause</h2>
                    <div>
                        <label for="wpn_rootCause" class="block text-sm font-medium text-gray-700">Descriere Root Cause<span class="text-red-500 ml-1">*</span></label>
                        <textarea id="wpn_rootCause" rows="4" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required></textarea>
                    </div>
                </div>
                <!-- Sección 8: Corrective Actions -->
                <div>
                    <h2 class="text-xl font-semibold text-green-700 border-b pb-2 mb-4">Secțiunea 8: Corrective Actions</h2>
                    <div>
                        <label for="wpn_correctiveActions" class="block text-sm font-medium text-gray-700">Descriere Corrective Actions<span class="text-red-500 ml-1">*</span></label>
                        <textarea id="wpn_correctiveActions" rows="4" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required></textarea>
                    </div>
                </div>
                <!-- Div de Notificación de Error -->
                <div id="error-notification-wpn" class="hidden p-4 mb-4 text-sm text-red-800 bg-red-100 rounded-lg" role="alert"></div>
                <!-- Botón de Generar -->
                <div class="pt-6 border-t">
                    <button type="submit" class="w-full bg-indigo-600 text-white font-bold py-3 px-6 rounded-lg shadow-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition-all duration-150">
                        Generează Tabelul (WPN)
                    </button>
                </div>
            </form>
            <!-- Contenedor de Salida de Tabla -->
            <div id="output-container-wpn" class="mt-12" style="display: none;">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-2xl font-bold text-gray-800">Tabelul Generat (WPN)</h2>
                    <div class="relative">
                        <button id="copy-btn-wpn" class="bg-green-600 text-white text-xs font-bold py-2 px-4 rounded-md hover:bg-green-700 transition-all duration-150">
                            Copiază Tabelul
                        </button>
                        <span id="copy-notification-wpn" class="absolute top-0 left-full ml-4 bg-gray-800 text-white text-xs font-bold py-2 px-3 rounded-md opacity-0 whitespace-nowrap">
                            Copiata!
                        </span>
                    </div>
                </div>
                <div>
                    <p class="text-sm text-gray-600 mb-4">Tabelul este gata. Faceți clic pe "Copiază Tabelul" și lipiți-l direct în e-mailul dumneavoastră.</p>
                    <div id="table-output-wpn" class="shadow-lg rounded-lg border border-black overflow-hidden">
                        <!-- La tabla WPN se insertará aquí -->
                    </div>
                </div>
            </div>
            <!-- Fin Contenedor de Salida de Tabla WPN -->
        </div>
        <!-- Fin Contenedor Oculto WPN -->


        <!-- Contenedor Oculto para Formulario 2 (Wrong Process) -->
        <div id="form-container-wp" class="form-container">
            <h2 class="text-2xl font-bold text-gray-800 mb-4 border-b pb-2">Formular: Wrong Process SMT</h2>
            <form id="data-form-wp" class="space-y-6" novalidate>
                <!-- Sección 1: QT Technician (WP) -->
                <div>
                    <h2 class="text-xl font-semibold text-indigo-700 border-b pb-2 mb-4">Secțiunea 1: QT Technician</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4">
                        <!-- v34.0: Nuevo campo de selección -->
                        <div class="md:col-span-2">
                            <label for="wp_selectProcess" class="block text-sm font-medium text-gray-700">Select Wrong Process<span class="text-red-500 ml-1">*</span></label>
                            <select id="wp_selectProcess" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                                <option value="">Selectați...</option>
                                <option value="Missing Component">Missing Component</option>
                                <option value="Misplaced Component">Misplaced Component</option>
                                <option value="Extra Component">Extra Component</option>
                                <option value="Solder Bridge Defect">Solder Bridge Defect</option>
                                <option value="Insufficient Solder Defect">Insufficient Solder Defect</option>
                                <option value="Open Defect">Open Defect</option>
                            </select>
                        </div>
                        <div class="md:col-span-2">
                            <label for="wp_qtModelPart" class="block text-sm font-medium text-gray-700">Model Part Number<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="wp_qtModelPart" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                        <div class="md:col-span-2">
                            <label for="wp_qtComponentPart" class="block text-sm font-medium text-gray-700">Component Part Number<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="wp_qtComponentPart" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                        <div class="md:col-span-2">
                            <label for="wp_qtSideAffected" class="block text-sm font-medium text-gray-700">Side Affected<span class="text-red-500 ml-1">*</span></label>
                            <select id="wp_qtSideAffected" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                                <option value="">Selectați...</option>
                                <option value="A">Side A</option>
                                <option value="B">Side B</option>
                                <option value="A+B">Side A + Side B</option>
                            </select>
                        </div>
                        <div>
                            <label for="wp_qtUsageSideA" class="block text-sm font-medium text-gray-700">Usage / Side (A)<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="wp_qtUsageSideA" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                        <div>
                            <label for="wp_qtUsageSideB" class="block text-sm font-medium text-gray-700">Usage / Side (B)<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="wp_qtUsageSideB" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                        <div>
                            <label for="wp_qtRefAffectedA" class="block text-sm font-medium text-gray-700">Reference Affected (A)<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="wp_qtRefAffectedA" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                         <div>
                            <label for="wp_qtRefAffectedB" class="block text-sm font-medium text-gray-700">Reference Affected (B)<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="wp_qtRefAffectedB" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                        <div>
                            <label for="wp_qtLineAffected" class="block text-sm font-medium text-gray-700">Line Affected<span class="text-red-500 ml-1">*</span></label>
                            <!-- v37.0: Campo cambiado a select -->
                            <select id="wp_qtLineAffected" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                                <option value="">Selectați...</option>
                                <option value="Linia 1 SMT (4701A)">Linia 1 SMT (4701A)</option>
                                <option value="Linia 2 SMT (4701B)">Linia 2 SMT (4701B)</option>
                                <option value="Linia 3 SMT (4701C)">Linia 3 SMT (4701C)</option>
                                <option value="Linia 4 SMT (4701D)">Linia 4 SMT (4701D)</option>
                                <option value="Linia 5 SMT (4701E)">Linia 5 SMT (4701E)</option>
                                <option value="Linia 6 SMT (4701F)">Linia 6 SMT (4701F)</option>
                                <option value="Linia 7 SMT (4701G)">Linia 7 SMT (4701G)</option>
                                <option value="Linia 10 SMT (4701J)">Linia 10 SMT (4701J)</option>
                            </select>
                        </div>
                        <div>
                            <label for="wp_qtWoAffected" class="block text-sm font-medium text-gray-700">Work Order Affected<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="wp_qtWoAffected" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                        <div>
                            <label for="wp_qtWoQty" class="block text-sm font-medium text-gray-700">Work Order QTY<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="wp_qtWoQty" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                        <div>
                            <label for="wp_qtDateShift" class="block text-sm font-medium text-gray-700">Date / Shift<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="wp_qtDateShift" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                    </div>
                </div>
                <!-- Sección 2: Test Inspection AOI (WP) -->
                <div>
                    <h2 class="text-xl font-semibold text-indigo-700 border-b pb-2 mb-4">Secțiunea 2: Test Inspection AOI</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4">
                        <div>
                            <label for="wp_aoiFalseCall" class="block text-sm font-medium text-gray-700">False Call on AOI / GSF ?<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="wp_aoiFalseCall" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                        <div>
                            <label for="wp_aoiPhotos" class="block text-sm font-medium text-gray-700">IF YES - Link To Photos (AOI)<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="wp_aoiPhotos" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                        <div>
                            <label for="wp_spiFalseCall" class="block text-sm font-medium text-gray-700">False Call on SPI ?<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="wp_spiFalseCall" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                        <div>
                            <label for="wp_spiPhotos" class="block text-sm font-medium text-gray-700">IF YES - Link To Photos (SPI)<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="wp_spiPhotos" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                    </div>
                </div>
                <!-- Sección 3: Test Debug - ICT / Functional Test (WP) -->
                <div>
                    <h2 class="text-xl font-semibold text-indigo-700 border-b pb-2 mb-4">Secțiunea 3: Test Debug - ICT / Functional Test</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4">
                        <div class="md:col-span-2">
                            <label for="wp_tdCoverage" class="block text-sm font-medium text-gray-700">We have Coverage on affected References?<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="wp_tdCoverage" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                    </div>
                </div>
                <!-- Sección 4: Containment Production / CFT (WP) -->
                <div>
                    <h2 class="text-xl font-semibold text-yellow-600 border-b pb-2 mb-4">Secțiunea 4: Containment Production / CFT</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4">
                        <div>
                            <label for="wp_cftCommonProcess" class="block text-sm font-medium text-gray-700">Common Process (WIP)<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="wp_cftCommonProcess" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                        <div>
                            <label for="wp_cftLine" class="block text-sm font-medium text-gray-700">CFT Line (MPF)<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="wp_cftLine" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                        <div>
                            <label for="wp_cftTotalQty" class="block text-sm font-medium text-gray-700">Total QTY Affected<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="wp_cftTotalQty" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                        <div>
                            <label for="wp_cftAllAffectedSN" class="block text-sm font-medium text-gray-700">All Affected (S/N) Serial Numbers Was Sent To Fix?<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="wp_cftAllAffectedSN" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                    </div>
                </div>
                <!-- Sección 5: Root Cause (WP) -->
                <div>
                    <h2 class="text-xl font-semibold text-gray-700 border-b pb-2 mb-4">Secțiunea 5: Root Cause</h2>
                    <div>
                        <!-- v34.0: Etiqueta cambiada -->
                        <label for="wp_rootCause" class="block text-sm font-medium text-gray-700">Descriere Root Cause<span class="text-red-500 ml-1">*</span></label>
                        <textarea id="wp_rootCause" rows="4" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required></textarea>
                    </div>
                </div>
                <!-- Sección 6: Corrective Actions (WP) -->
                <div>
                    <h2 class="text-xl font-semibold text-green-700 border-b pb-2 mb-4">Secțiunea 6: Corrective Actions</h2>
                    <div>
                        <label for="wp_correctiveActions" class="block text-sm font-medium text-gray-700">Descriere Corrective Actions<span class="text-red-500 ml-1">*</span></label>
                        <textarea id="wp_correctiveActions" rows="4" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required></textarea>
                    </div>
                </div>
                <!-- Div de Notificación de Error -->
                <div id="error-notification-wp" class="hidden p-4 mb-4 text-sm text-red-800 bg-red-100 rounded-lg" role="alert"></div>
                <!-- Botón de Generar -->
                <div class="pt-6 border-t">
                    <button type="submit" class="w-full bg-indigo-600 text-white font-bold py-3 px-6 rounded-lg shadow-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition-all duration-150">
                        Generează Tabelul (WP)
                    </button>
                </div>
            </form>
            <!-- Contenedor de Salida de Tabla (WP) -->
            <div id="output-container-wp" class="mt-12" style="display: none;">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-2xl font-bold text-gray-800">Tabelul Generat (WP)</h2>
                    <div class="relative">
                        <button id="copy-btn-wp" class="bg-green-600 text-white text-xs font-bold py-2 px-4 rounded-md hover:bg-green-700 transition-all duration-150">
                            Copiază Tabelul
                        </button>
                        <span id="copy-notification-wp" class="absolute top-0 left-full ml-4 bg-gray-800 text-white text-xs font-bold py-2 px-3 rounded-md opacity-0 whitespace-nowrap">
                            Copiata!
                        </span>
                    </div>
                </div>
                <div>
                    <p class="text-sm text-gray-600 mb-4">Tabelul este gata. Faceți clic pe "Copiază Tabelul" și lipiți-l direct în e-mailul dumneavoastră.</p>
                    <div id="table-output-wp" class="shadow-lg rounded-lg border border-black overflow-hidden">
                        <!-- La tabla WP se insertará aquí -->
                    </div>
                </div>
            </div>
            <!-- Fin Contenedor de Salida de Tabla WP -->
        </div>
        <!-- Fin Contenedor Oculto WP -->

        
        <!-- Contenedor Oculto para Formulario 3 (Wrong Orientation) -->
        <div id="form-container-wo" class="form-container">
            
            <h2 class="text-2xl font-bold text-gray-800 mb-4 border-b pb-2">Formular: Wrong Orientation</h2>
            <form id="data-form-wo" class="space-y-6" novalidate>
                <!-- Sección 1: QT Technician (WO) -->
                <div>
                    <h2 class="text-xl font-semibold text-indigo-700 border-b pb-2 mb-4">Secțiunea 1: QT Technician</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4">
                        <div class="md:col-span-2">
                            <label for="wo_qtModelPart" class="block text-sm font-medium text-gray-700">Model Part Number<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="wo_qtModelPart" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                        <div class="md:col-span-2">
                            <label for="wo_qtComponentPart" class="block text-sm font-medium text-gray-700">Component Part Number<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="wo_qtComponentPart" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                        <div class="md:col-span-2">
                            <label for="wo_qtSideAffected" class="block text-sm font-medium text-gray-700">Side Affected<span class="text-red-500 ml-1">*</span></label>
                            <select id="wo_qtSideAffected" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                                <option value="">Selectați...</option>
                                <option value="A">Side A</option>
                                <option value="B">Side B</option>
                                <option value="A+B">Side A + Side B</option>
                            </select>
                        </div>
                        <div>
                            <label for="wo_qtUsageSideA" class="block text-sm font-medium text-gray-700">Usage / Side (A)<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="wo_qtUsageSideA" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                        <div>
                            <label for="wo_qtUsageSideB" class="block text-sm font-medium text-gray-700">Usage / Side (B)<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="wo_qtUsageSideB" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                        <div>
                            <label for="wo_qtRefAffectedA" class="block text-sm font-medium text-gray-700">Reference Affected (A)<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="wo_qtRefAffectedA" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                         <div>
                            <label for="wo_qtRefAffectedB" class="block text-sm font-medium text-gray-700">Reference Affected (B)<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="wo_qtRefAffectedB" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                        <div>
                            <label for="wo_qtLineAffected" class="block text-sm font-medium text-gray-700">Line Affected<span class="text-red-500 ml-1">*</span></label>
                            <!-- v37.0: Campo cambiado a select -->
                            <select id="wo_qtLineAffected" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                                <option value="">Selectați...</option>
                                <option value="Linia 1 SMT (4701A)">Linia 1 SMT (4701A)</option>
                                <option value="Linia 2 SMT (4701B)">Linia 2 SMT (4701B)</option>
                                <option value="Linia 3 SMT (4701C)">Linia 3 SMT (4701C)</option>
                                <option value="Linia 4 SMT (4701D)">Linia 4 SMT (4701D)</option>
                                <option value="Linia 5 SMT (4701E)">Linia 5 SMT (4701E)</option>
                                <option value="Linia 6 SMT (4701F)">Linia 6 SMT (4701F)</option>
                                <option value="Linia 7 SMT (4701G)">Linia 7 SMT (4701G)</option>
                                <option value="Linia 10 SMT (4701J)">Linia 10 SMT (4701J)</option>
                            </select>
                        </div>
                        <div>
                            <label for="wo_qtWoAffected" class="block text-sm font-medium text-gray-700">Work Order Affected<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="wo_qtWoAffected" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                        <div>
                            <label for="wo_qtWoQty" class="block text-sm font-medium text-gray-700">Work Order QTY<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="wo_qtWoQty" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                        <div>
                            <label for="wo_qtDateShift" class="block text-sm font-medium text-gray-700">Date / Shift<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="wo_qtDateShift" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                    </div>
                </div>
                <!-- Sección 2: Test Inspection AOI (WO) -->
                <div>
                    <h2 class="text-xl font-semibold text-indigo-700 border-b pb-2 mb-4">Secțiunea 2: Test Inspection AOI</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4">
                        <div>
                            <label for="wo_aoiFalseCall" class="block text-sm font-medium text-gray-700">False Call on AOI / GSF ?<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="wo_aoiFalseCall" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                        <div>
                            <label for="wo_aoiPhotos" class="block text-sm font-medium text-gray-700">IF YES - Link To Photos<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="wo_aoiPhotos" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                    </div>
                </div>
                <!-- Sección 3: Test Debug - ICT / Functional Test (WO) -->
                <div>
                    <h2 class="text-xl font-semibold text-indigo-700 border-b pb-2 mb-4">Secțiunea 3: Test Debug - ICT / Functional Test</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4">
                        <div class="md:col-span-2">
                            <label for="wo_tdCoverage" class="block text-sm font-medium text-gray-700">We have Coverage on affected References?<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="wo_tdCoverage" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                    </div>
                </div>
                <!-- Sección 4: Containment Production / CFT (WO) -->
                <div>
                    <h2 class="text-xl font-semibold text-yellow-600 border-b pb-2 mb-4">Secțiunea 4: Containment Production / CFT</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4">
                        <div>
                            <label for="wo_cftCommonProcess" class="block text-sm font-medium text-gray-700">Common Process (WIP)<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="wo_cftCommonProcess" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                        <div>
                            <label for="wo_cftLine" class="block text-sm font-medium text-gray-700">CFT Line (MPF)<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="wo_cftLine" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                        <div>
                            <label for="wo_cftTotalQty" class="block text-sm font-medium text-gray-700">Total QTY Affected<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="wo_cftTotalQty" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                        <div>
                            <label for="wo_cftAllAffectedSN" class="block text-sm font-medium text-gray-700">All Affected (S/N) Serial Numbers Was Sent To Fix?<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="wo_cftAllAffectedSN" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                    </div>
                </div>
                <!-- v35.0: Nueva Sección 5: Process Tech / Engineering (WO) -->
                <div>
                    <h2 class="text-xl font-semibold text-red-700 border-b pb-2 mb-4">Secțiunea 5: Process Tech / Engineering</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4">
                        <div class="md:col-span-2">
                            <label for="wo_ptCheckOrientation" class="block text-sm font-medium text-gray-700">Check Pick-Up Orientation Was Set on Siplace?<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="wo_ptCheckOrientation" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                    </div>
                </div>
                <!-- Sección 6: Root Cause (WO) -->
                <div>
                    <h2 class="text-xl font-semibold text-gray-700 border-b pb-2 mb-4">Secțiunea 6: Root Cause</h2>
                    <div>
                        <label for="wo_rootCause" class="block text-sm font-medium text-gray-700">Descriere Root Cause<span class="text-red-500 ml-1">*</span></label>
                        <textarea id="wo_rootCause" rows="4" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required></textarea>
                    </div>
                </div>
                <!-- Sección 7: Corrective Actions (WO) -->
                <div>
                    <h2 class="text-xl font-semibold text-green-700 border-b pb-2 mb-4">Secțiunea 7: Corrective Actions</h2>
                    <div>
                        <label for="wo_correctiveActions" class="block text-sm font-medium text-gray-700">Descriere Corrective Actions<span class="text-red-500 ml-1">*</span></label>
                        <textarea id="wo_correctiveActions" rows="4" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required></textarea>
                    </div>
                </div>
                <!-- Div de Notificación de Error -->
                <div id="error-notification-wo" class="hidden p-4 mb-4 text-sm text-red-800 bg-red-100 rounded-lg" role="alert"></div>
                <!-- Botón de Generar -->
                <div class="pt-6 border-t">
                    <button type="submit" class="w-full bg-indigo-600 text-white font-bold py-3 px-6 rounded-lg shadow-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition-all duration-150">
                        Generează Tabelul (WO)
                    </button>
                </div>
            </form>
            <!-- Contenedor de Salida de Tabla (WO) -->
            <div id="output-container-wo" class="mt-12" style="display: none;">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-2xl font-bold text-gray-800">Tabelul Generat (WO)</h2>
                    <div class="relative">
                        <button id="copy-btn-wo" class="bg-green-600 text-white text-xs font-bold py-2 px-4 rounded-md hover:bg-green-700 transition-all duration-150">
                            Copiază Tabelul
                        </button>
                        <span id="copy-notification-wo" class="absolute top-0 left-full ml-4 bg-gray-800 text-white text-xs font-bold py-2 px-3 rounded-md opacity-0 whitespace-nowrap">
                            Copiata!
                        </span>
                    </div>
                </div>
                <div>
                    <p class="text-sm text-gray-600 mb-4">Tabelul este gata. Faceți clic pe "Copiază Tabelul" și lipiți-l direct în e-mailul dumneavoastră.</p>
                    <div id="table-output-wo" class="shadow-lg rounded-lg border border-black overflow-hidden">
                        <!-- La tabla WO se insertará aquí -->
                    </div>
                </div>
            </div>
            <!-- Fin Contenedor de Salida de Tabla WO -->
        </div>
        <!-- Fin Contenedor Oculto WO -->


        <!-- v36.0: Contenedor Oculto para Formulario 4 (MSL Expirat) -->
        <div id="form-container-msl" class="form-container">
            
            <h2 class="text-2xl font-bold text-gray-800 mb-4 border-b pb-2">Formular: MSL Expirat</h2>

            <!-- Formulario de Entrada de Datos 4 (MSL) -->
            <form id="data-form-msl" class="space-y-6" novalidate>

                <!-- Sección 1: Detalii MSL (MSL) -->
                <div>
                    <h2 class="text-xl font-semibold text-indigo-700 border-b pb-2 mb-4">Secțiunea 1: Detalii MSL</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4">
                        <div>
                            <label for="msl_type" class="block text-sm font-medium text-gray-700">MSL Type<span class="text-red-500 ml-1">*</span></label>
                            <!-- v37.0: Campo cambiado a select -->
                            <select id="msl_type" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                                <option value="">Selectați...</option>
                                <option value="MSL 2 (1 An)">MSL 2 (1 An)</option>
                                <option value="MSL 2a (672 Ore)">MSL 2a (672 Ore)</option>
                                <option value="MSL 3 (168 Ore)">MSL 3 (168 Ore)</option>
                                <option value="MSL 4 (72 Ore)">MSL 4 (72 Ore)</option>
                                <option value="MSL 5 (48 Ore)">MSL 5 (48 Ore)</option>
                                <option value="MSL 5a (24 Ore)">MSL 5a (24 Ore)</option>
                                <option value="MSL 6 (Obligatoriu Bake Before Use)">MSL 6 (Obligatoriu Bake Before Use)</option>
                            </select>
                        </div>
                        <div>
                            <label for="msl_totalHours" class="block text-sm font-medium text-gray-700">Total Number of Hours<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="msl_totalHours" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                        <div>
                            <label for="msl_timeExpired" class="block text-sm font-medium text-gray-700">Date / Time when expired<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="msl_timeExpired" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                        <div>
                            <label for="msl_timeFound" class="block text-sm font-medium text-gray-700">Date / Time when found on Line<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="msl_timeFound" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                        <div>
                            <label for="msl_lineAffected" class="block text-sm font-medium text-gray-700">Line Affected<span class="text-red-500 ml-1">*</span></label>
                            <!-- v37.0: Campo cambiado a select -->
                            <select id="msl_lineAffected" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                                <option value="">Selectați...</option>
                                <option value="Linia 1 SMT (4701A)">Linia 1 SMT (4701A)</option>
                                <option value="Linia 2 SMT (4701B)">Linia 2 SMT (4701B)</option>
                                <option value="Linia 3 SMT (4701C)">Linia 3 SMT (4701C)</option>
                                <option value="Linia 4 SMT (4701D)">Linia 4 SMT (4701D)</option>
                                <option value="Linia 5 SMT (4701E)">Linia 5 SMT (4701E)</option>
                                <option value="Linia 6 SMT (4701F)">Linia 6 SMT (4701F)</option>
                                <option value="Linia 7 SMT (4701G)">Linia 7 SMT (4701G)</option>
                                <option value="Linia 10 SMT (4701J)">Linia 10 SMT (4701J)</option>
                            </select>
                        </div>
                        <div>
                            <label for="msl_modelPart" class="block text-sm font-medium text-gray-700">Model Part Number<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="msl_modelPart" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                        <div>
                            <label for="msl_workOrder" class="block text-sm font-medium text-gray-700">Work Order<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="msl_workOrder" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                        <div>
                            <label for="msl_componentPart" class="block text-sm font-medium text-gray-700">Component Part Number Expired<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="msl_componentPart" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                        <div>
                            <label for="msl_mpnPart" class="block text-sm font-medium text-gray-700">MPN Part Number<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="msl_mpnPart" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                        <div>
                            <label for="msl_licensePlate" class="block text-sm font-medium text-gray-700">License Plate Expired (LP)<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="msl_licensePlate" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                        <div>
                            <label for="msl_qtyLp" class="block text-sm font-medium text-gray-700">QTY LP Expired<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="msl_qtyLp" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                        
                        <div class="md:col-span-2">
                            <label for="msl_qtSideAffected" class="block text-sm font-medium text-gray-700">Side Affected<span class="text-red-500 ml-1">*</span></label>
                            <select id="msl_qtSideAffected" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                                <option value="">Selectați...</option>
                                <option value="A">Side A</option>
                                <option value="B">Side B</option>
                                <option value="A+B">Side A + Side B</option>
                            </select>
                        </div>
                        <div>
                            <label for="msl_qtUsageSideA" class="block text-sm font-medium text-gray-700">Usage / Side (A)<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="msl_qtUsageSideA" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                        <div>
                            <label for="msl_qtUsageSideB" class="block text-sm font-medium text-gray-700">Usage / Side (B)<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="msl_qtUsageSideB" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                        <div>
                            <label for="msl_qtRefAffectedA" class="block text-sm font-medium text-gray-700">Reference Affected (A)<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="msl_qtRefAffectedA" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                         <div>
                            <label for="msl_qtRefAffectedB" class="block text-sm font-medium text-gray-700">Reference Affected (B)<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="msl_qtRefAffectedB" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>

                        <div>
                            <label for="msl_qtyPcba" class="block text-sm font-medium text-gray-700">QTY PCBA Affected<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="msl_qtyPcba" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                        <div>
                            <label for="msl_greenCard" class="block text-sm font-medium text-gray-700">Green Card (MSL Setup Indicator)<span class="text-red-500 ml-1">*</span></label>
                            <!-- v37.0: Campo cambiado a select -->
                            <select id="msl_greenCard" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                                <option value="">Selectați...</option>
                                <option value="Yes">Yes</option>
                                <option value="No">No</option>
                            </select>
                        </div>
                        <div class="md:col-span-2">
                            <label for="msl_formReport" class="block text-sm font-medium text-gray-700">Form. 13620-MSL Report<span class="text-red-500 ml-1">*</span></label>
                            <!-- v37.0: Campo cambiado a select -->
                            <select id="msl_formReport" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                                <option value="">Selectați...</option>
                                <option value="Yes">Yes</option>
                                <option value="No">No</option>
                            </select>
                        </div>
                    </div>
                </div>
                <!-- Sección 2: Descrieri (MSL) -->
                <div>
                    <h2 class="text-xl font-semibold text-gray-700 border-b pb-2 mb-4">Secțiunea 2: Containment / Root Cause / Corrective Actions</h2>
                    <div>
                        <label for="msl_containment" class="block text-sm font-medium text-gray-700">Containment / SMT Production<span class="text-red-500 ml-1">*</span></label>
                        <textarea id="msl_containment" rows="4" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required></textarea>
                    </div>
                    <div class="mt-4">
                        <label for="msl_rootCause" class="block text-sm font-medium text-gray-700">Descriere Root Cause<span class="text-red-500 ml-1">*</span></label>
                        <textarea id="msl_rootCause" rows="4" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required></textarea>
                    </div>
                    <div class="mt-4">
                        <label for="msl_correctiveActions" class="block text-sm font-medium text-gray-700">Descriere Corrective Actions<span class="text-red-500 ml-1">*</span></label>
                        <textarea id="msl_correctiveActions" rows="4" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required></textarea>
                    </div>
                </div>

                <!-- Div de Notificación de Error -->
                <div id="error-notification-msl" class="hidden p-4 mb-4 text-sm text-red-800 bg-red-100 rounded-lg" role="alert"></div>
                <!-- Botón de Generar -->
                <div class="pt-6 border-t">
                    <button type="submit" class="w-full bg-indigo-600 text-white font-bold py-3 px-6 rounded-lg shadow-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition-all duration-150">
                        Generează Tabelul (MSL)
                    </button>
                </div>
            </form>
            <!-- Contenedor de Salida de Tabla (MSL) -->
            <div id="output-container-msl" class="mt-12" style="display: none;">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-2xl font-bold text-gray-800">Tabelul Generat (MSL)</h2>
                    <div class="relative">
                        <button id="copy-btn-msl" class="bg-green-600 text-white text-xs font-bold py-2 px-4 rounded-md hover:bg-green-700 transition-all duration-150">
                            Copiază Tabelul
                        </button>
                        <span id="copy-notification-msl" class="absolute top-0 left-full ml-4 bg-gray-800 text-white text-xs font-bold py-2 px-3 rounded-md opacity-0 whitespace-nowrap">
                            Copiata!
                        </span>
                    </div>
                </div>
                <div>
                    <p class="text-sm text-gray-600 mb-4">Tabelul este gata. Faceți clic pe "Copiază Tabelul" și lipiți-l direct în e-mailul dumneavoastră.</p>
                    <div id="table-output-msl" class="shadow-lg rounded-lg border border-black overflow-hidden">
                        <!-- La tabla MSL se insertará aquí -->
                    </div>
                </div>
            </div>
            <!-- Fin Contenedor de Salida de Tabla MSL -->
        </div>
        <!-- Fin Contenedor Oculto MSL -->
        
        
        <!-- v38.0: Contenedor Oculto para Formulario 5 (Wrong Process Soldering) -->
        <div id="form-container-wps" class="form-container">
            
            <h2 class="text-2xl font-bold text-gray-800 mb-4 border-b pb-2">Formular: Wrong Process Soldering</h2>

            <!-- Formulario de Entrada de Datos 5 (WPS) -->
            <form id="data-form-wps" class="space-y-6" novalidate>

                <!-- v39.0: Opciones de Select actualizadas -->
                <div class="md:col-span-2">
                    <label for="wps_selectProcess" class="block text-sm font-medium text-gray-700">Select Wrong Process<span class="text-red-500 ml-1">*</span></label>
                    <select id="wps_selectProcess" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        <option value="">Selectați...</option>
                        <option value="Missing Component SMT">Missing Component SMT</option>
                        <option value="Solder Bridge Defect">Solder Bridge Defect</option>
                        <option value="Insufficient Solder Defect">Insufficient Solder Defect</option>
                        <option value="Open Defect">Open Defect</option>
                    </select>
                </div>

                <!-- Sección 1: Problem Description (WPS) -->
                <div>
                    <h2 class="text-xl font-semibold text-indigo-700 border-b pb-2 mb-4">Secțiunea 1: Problem Description</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4">
                        <div class="md:col-span-2">
                            <label for="wps_pdPCBA_PN" class="block text-sm font-medium text-gray-700">PCBA Part Number<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="wps_pdPCBA_PN" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                        <div class="md:col-span-2">
                            <label for="wps_pdComponent_PN" class="block text-sm font-medium text-gray-700">Component Part Number<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="wps_pdComponent_PN" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                        <div class="md:col-span-2">
                            <label for="wps_pdSideAffected" class="block text-sm font-medium text-gray-700">Side Affected<span class="text-red-500 ml-1">*</span></label>
                            <select id="wps_pdSideAffected" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                                <option value="">Selectați...</option>
                                <option value="A">Side A</option>
                                <option value="B">Side B</option>
                                <option value="A+B">Side A + Side B</option>
                            </select>
                        </div>
                        <div>
                            <label for="wps_pdUsageSideA" class="block text-sm font-medium text-gray-700">Usage / Side (A)<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="wps_pdUsageSideA" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                        <div>
                            <label for="wps_pdUsageSideB" class="block text-sm font-medium text-gray-700">Usage / Side (B)<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="wps_pdUsageSideB" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                        <div>
                            <label for="wps_pdRefDesA" class="block text-sm font-medium text-gray-700">Ref. des. (A)<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="wps_pdRefDesA" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                         <div>
                            <label for="wps_pdRefDesB" class="block text-sm font-medium text-gray-700">Ref. des. (B)<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="wps_pdRefDesB" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                        <div>
                            <label for="wps_pdLine" class="block text-sm font-medium text-gray-700">Line<span class="text-red-500 ml-1">*</span></label>
                             <!-- v39.0: Opciones de Line actualizadas -->
                             <select id="wps_pdLine" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                                <option value="">Selectați...</option>
                                <option value="Selective 1">Selective 1</option>
                                <option value="Selective 2">Selective 2</option>
                                <option value="Selective 3">Selective 3</option>
                                <option value="Selective 4">Selective 4</option>
                                <option value="Selective 5">Selective 5</option>
                                <option value="Wave 1">Wave 1</option>
                                <option value="Wave 2">Wave 2</option>
                                <option value="Wave 3">Wave 3</option>
                                <option value="Wave 4">Wave 4</option>
                                <option value="Wave 5">Wave 5</option>
                                <option value="Wave 6">Wave 6</option>
                                <option value="Wave 7">Wave 7</option>
                            </select>
                        </div>
                        <div>
                            <label for="wps_pdWorkOrder" class="block text-sm font-medium text-gray-700">Work Order<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="wps_pdWorkOrder" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                        <div>
                            <label for="wps_pdWO_QTY" class="block text-sm font-medium text-gray-700">WO QTY<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="wps_pdWO_QTY" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                        <div>
                            <label for="wps_pdDateShift" class="block text-sm font-medium text-gray-700">Date / Shift<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="wps_pdDateShift" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                    </div>
                </div>
                <!-- Sección 2: Containment (WPS) -->
                <div>
                    <h2 class="text-xl font-semibold text-yellow-600 border-b pb-2 mb-4">Secțiunea 2: Containment</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4">
                        <div>
                            <label for="wps_contCommonProcess" class="block text-sm font-medium text-gray-700">Common processes (WIP)<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="wps_contCommonProcess" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                        <div>
                            <label for="wps_contCFTLine" class="block text-sm font-medium text-gray-700">CFT line (MPF)<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="wps_contCFTLine" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                        <div>
                            <label for="wps_contTotalQTY" class="block text-sm font-medium text-gray-700">Total affected QTY<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="wps_contTotalQTY" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                        <div>
                            <!-- v40.0: Campo cambiado a input -->
                            <label for="wps_contAllAffectedSN" class="block text-sm font-medium text-gray-700">All affected S/N was sent to Fix?<span class="text-red-500 ml-1">*</span></label>
                             <input type="text" id="wps_contAllAffectedSN" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                    </div>
                </div>
                <!-- Sección 3: X-ray (WPS) -->
                <div>
                    <h2 class="text-xl font-semibold text-cyan-700 border-b pb-2 mb-4">Secțiunea 3: X-ray</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4">
                        <div>
                            <!-- v40.0: Campo cambiado a input -->
                            <label for="wps_xrayInProcess" class="block text-sm font-medium text-gray-700">X-ray manual/automat in process flow?<span class="text-red-500 ml-1">*</span></label>
                             <input type="text" id="wps_xrayInProcess" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                        <div>
                            <label for="wps_xrayResult" class="block text-sm font-medium text-gray-700">X-ray result<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="wps_xrayResult" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                    </div>
                </div>
                <!-- Sección 4: Test Debug (WPS) -->
                <div>
                    <h2 class="text-xl font-semibold text-green-700 border-b pb-2 mb-4">Secțiunea 4: Test Debug - ICT / Functional Test</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4">
                        <div class="md:col-span-2">
                            <label for="wps_tdCoverage" class="block text-sm font-medium text-gray-700">We have coverage on affected references?<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="wps_tdCoverage" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required placeholder="YES / NO / Only on...">
                        </div>
                    </div>
                </div>
                <!-- Sección 5: Root Cause (WPS) -->
                <div>
                    <h2 class="text-xl font-semibold text-gray-700 border-b pb-2 mb-4">Secțiunea 5: Root Cause</h2>
                    <div>
                        <label for="wps_rootCause" class="block text-sm font-medium text-gray-700">Descriere Root Cause<span class="text-red-500 ml-1">*</span></label>
                        <textarea id="wps_rootCause" rows="4" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required></textarea>
                    </div>
                </div>
                <!-- Sección 6: Corrective Actions (WPS) -->
                <div>
                    <h2 class="text-xl font-semibold text-purple-700 border-b pb-2 mb-4">Secțiunea 6: Corrective Actions</h2>
                    <div>
                        <label for="wps_correctiveActions" class="block text-sm font-medium text-gray-700">Descriere Corrective Actions<span class="text-red-500 ml-1">*</span></label>
                        <textarea id="wps_correctiveActions" rows="4" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required></textarea>
                    </div>
                </div>

                <!-- Div de Notificación de Error -->
                <div id="error-notification-wps" class="hidden p-4 mb-4 text-sm text-red-800 bg-red-100 rounded-lg" role="alert"></div>
                <!-- Botón de Generar -->
                <div class="pt-6 border-t">
                    <button type="submit" class="w-full bg-indigo-600 text-white font-bold py-3 px-6 rounded-lg shadow-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition-all duration-150">
                        Generează Tabelul (WPS)
                    </button>
                </div>
            </form>
            <!-- Contenedor de Salida de Tabla (WPS) -->
            <div id="output-container-wps" class="mt-12" style="display: none;">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-2xl font-bold text-gray-800">Tabelul Generat (WPS)</h2>
                    <div class="relative">
                        <button id="copy-btn-wps" class="bg-green-600 text-white text-xs font-bold py-2 px-4 rounded-md hover:bg-green-700 transition-all duration-150">
                            Copiază Tabelul
                        </button>
                        <span id="copy-notification-wps" class="absolute top-0 left-full ml-4 bg-gray-800 text-white text-xs font-bold py-2 px-3 rounded-md opacity-0 whitespace-nowrap">
                            Copiata!
                        </span>
                    </div>
                </div>
                <div>
                    <p class="text-sm text-gray-600 mb-4">Tabelul este gata. Faceți clic pe "Copiază Tabelul" și lipiți-l direct în e-mailul dumneavoastră.</p>
                    <div id="table-output-wps" class="shadow-lg rounded-lg border border-black overflow-hidden">
                        <!-- La tabla WPS se insertará aquí -->
                    </div>
                </div>
            </div>
            <!-- Fin Contenedor de Salida de Tabla WPS -->
        </div>
        <!-- Fin Contenedor Oculto WPS -->
<!-- v42.0: Contenedor Oculto para Formulario 6 (Insertion Defects) -->
        <div id="form-container-id" class="form-container">
            
            <h2 class="text-2xl font-bold text-gray-800 mb-4 border-b pb-2">Formular: Insertion Defects</h2>

            <!-- Formulario de Entrada de Datos 6 (ID) -->
            <!-- Formulario de Entrada de Datos 6 (ID) - v43.0 Actualizado -->
            <form id="data-form-id" class="space-y-6" novalidate>

                <!-- v42.0: Opciones de Select actualizadas para Insertion Defects -->
                <div class="md:col-span-2">
                    <label for="id_selectDefect" class="block text-sm font-medium text-gray-700">Select Insertion Defect<span class="text-red-500 ml-1">*</span></label>
                    <select id="id_selectDefect" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        <option value="">Selectați...</option>
                        <option value="Wrong Part Number (PTH)">Wrong Part Number (PTH)</option>
                        <option value="Missing Component (PTH)">Missing Component (PTH)</option>
                        <option value="Extra Component (PTH)">Extra Component (PTH)</option>
                        <option value="Wrong Orientation (PTH)">Wrong Orientation (PTH)</option>
                        <option value="Improper Mounting Height (PTH)">Improper Mounting Height (PTH)</option>
                        <option value="Improper Lead Protrusion (PTH)">Improper Lead Protrusion (PTH)</option>
                    </select>
                </div>

                <!-- Sección 1: Problem Description (ID) -->
                <div>
                    <h2 class="text-xl font-semibold text-indigo-700 border-b pb-2 mb-4">Secțiunea 1: Problem Description</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4">
                        <div class="md:col-span-2">
                            <label for="id_pdPCBA_PN" class="block text-sm font-medium text-gray-700">PCBA Part Number<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="id_pdPCBA_PN" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                        <div class="md:col-span-2">
                            <label for="id_pdComponent_PN" class="block text-sm font-medium text-gray-700">Component Part Number<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="id_pdComponent_PN" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                        <div class="md:col-span-2">
                            <label for="id_pdSideAffected" class="block text-sm font-medium text-gray-700">Side Affected<span class="text-red-500 ml-1">*</span></label>
                            <select id="id_pdSideAffected" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                                <option value="">Selectați...</option>
                                <option value="A">Side A</option>
                                <option value="B">Side B</option>
                                <option value="A+B">Side A + Side B</option>
                            </select>
                        </div>
                        <div>
                            <label for="id_pdUsageSideA" class="block text-sm font-medium text-gray-700">Usage / Side (A)<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="id_pdUsageSideA" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                        <div>
                            <label for="id_pdUsageSideB" class="block text-sm font-medium text-gray-700">Usage / Side (B)<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="id_pdUsageSideB" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                        <div>
                            <label for="id_pdRefDesA" class="block text-sm font-medium text-gray-700">Ref. des. (A)<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="id_pdRefDesA" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                         <div>
                            <label for="id_pdRefDesB" class="block text-sm font-medium text-gray-700">Ref. des. (B)<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="id_pdRefDesB" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                        <div>
                            <label for="id_pdLine" class="block text-sm font-medium text-gray-700">Line<span class="text-red-500 ml-1">*</span></label>
                             <select id="id_pdLine" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                                <option value="">Selectați...</option>
                                <option value="Selective 1">Selective 1</option>
                                <option value="Selective 2">Selective 2</option>
                                <option value="Selective 3">Selective 3</option>
                                <option value="Selective 4">Selective 4</option>
                                <option value="Selective 5">Selective 5</option>
                                <option value="Wave 1">Wave 1</option>
                                <option value="Wave 2">Wave 2</option>
                                <option value="Wave 3">Wave 3</option>
                                <option value="Wave 4">Wave 4</option>
                                <option value="Wave 5">Wave 5</option>
                                <option value="Wave 6">Wave 6</option>
                                <option value="Wave 7">Wave 7</option>
                            </select>
                        </div>
                        <div>
                            <label for="id_pdWorkOrder" class="block text-sm font-medium text-gray-700">Work Order<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="id_pdWorkOrder" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                        <div>
                            <label for="id_pdWO_QTY" class="block text-sm font-medium text-gray-700">WO QTY<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="id_pdWO_QTY" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                        <div>
                            <label for="id_pdDateShift" class="block text-sm font-medium text-gray-700">Date / Shift<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="id_pdDateShift" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                    </div>
                </div>
                <!-- Sección 2: Containment (ID) -->
                <div>
                    <h2 class="text-xl font-semibold text-yellow-600 border-b pb-2 mb-4">Secțiunea 2: Containment</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4">
                        <div>
                            <label for="id_contCommonProcess" class="block text-sm font-medium text-gray-700">Common processes (WIP)<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="id_contCommonProcess" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                        <div>
                            <label for="id_contCFTLine" class="block text-sm font-medium text-gray-700">CFT line (MPF)<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="id_contCFTLine" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                        <div>
                            <label for="id_contTotalQTY" class="block text-sm font-medium text-gray-700">Total affected QTY<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="id_contTotalQTY" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                        <div>
                            <label for="id_contAllAffectedSN" class="block text-sm font-medium text-gray-700">All affected S/N was sent to Fix?<span class="text-red-500 ml-1">*</span></label>
                             <input type="text" id="id_contAllAffectedSN" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                    </div>
                </div>
                <!-- v43.0: Sección 3 actualizada a Test Inspection AAD -->
                <div>
                    <h2 class="text-xl font-semibold text-cyan-700 border-b pb-2 mb-4">Secțiunea 3: Test Inspection AAD</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4">
                        <div>
                            <label for="id_aadFalseCall" class="block text-sm font-medium text-gray-700">False Call on AAD?<span class="text-red-500 ml-1">*</span></label>
                             <input type="text" id="id_aadFalseCall" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                        <div>
                            <label for="id_aadPhotos" class="block text-sm font-medium text-gray-700">IF YES - Link To Photos<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="id_aadPhotos" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                    </div>
                </div>
                <!-- Sección 4: Test Debug (ID) -->
                <div>
                    <h2 class="text-xl font-semibold text-green-700 border-b pb-2 mb-4">Secțiunea 4: Test Debug - ICT / Functional Test</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4">
                        <div class="md:col-span-2">
                            <label for="id_tdCoverage" class="block text-sm font-medium text-gray-700">We have coverage on affected references?<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="id_tdCoverage" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required placeholder="YES / NO / Only on...">
                        </div>
                    </div>
                </div>
                <!-- v43.0: Nueva Sección 5: Setup Verification -->
                <div>
                    <h2 class="text-xl font-semibold text-orange-700 border-b pb-2 mb-4">Secțiunea 5: Setup Verification</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4">
                        <div class="md:col-span-2">
                            <label for="id_svVerification" class="block text-sm font-medium text-gray-700">Affected Component P/N Verification<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="id_svVerification" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                    </div>
                </div>
                <!-- v43.0: Sección re-numerada a 6 -->
                <div>
                    <h2 class="text-xl font-semibold text-gray-700 border-b pb-2 mb-4">Secțiunea 6: Root Cause</h2>
                    <div>
                        <label for="id_rootCause" class="block text-sm font-medium text-gray-700">Descriere Root Cause<span class="text-red-500 ml-1">*</span></label>
                        <textarea id="id_rootCause" rows="4" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required></textarea>
                    </div>
                </div>
                <!-- v43.0: Sección re-numerada a 7 -->
                <div>
                    <h2 class="text-xl font-semibold text-purple-700 border-b pb-2 mb-4">Secțiunea 7: Corrective Actions</h2>
                    <div>
                        <label for="id_correctiveActions" class="block text-sm font-medium text-gray-700">Descriere Corrective Actions<span class="text-red-500 ml-1">*</span></label>
                        <textarea id="id_correctiveActions" rows="4" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required></textarea>
                    </div>
                </div>

                <!-- Div de Notificación de Error -->
                <div id="error-notification-id" class="hidden p-4 mb-4 text-sm text-red-800 bg-red-100 rounded-lg" role="alert"></div>
                <!-- Botón de Generar -->
                <div class="pt-6 border-t">
                    <button type="submit" class="w-full bg-indigo-600 text-white font-bold py-3 px-6 rounded-lg shadow-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition-all duration-150">
                        Generează Tabelul (ID)
                    </button>
                </div>
            </form>
            <!-- Contenedor de Salida de Tabla (ID) -->
            <div id="output-container-id" class="mt-12" style="display: none;">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-2xl font-bold text-gray-800">Tabelul Generat (ID)</h2>
                    <div class="relative">
                        <button id="copy-btn-id" class="bg-green-600 text-white text-xs font-bold py-2 px-4 rounded-md hover:bg-green-700 transition-all duration-150">
                            Copiază Tabelul
                        </button>
                        <span id="copy-notification-id" class="absolute top-0 left-full ml-4 bg-gray-800 text-white text-xs font-bold py-2 px-3 rounded-md opacity-0 whitespace-nowrap">
                            Copiata!
                        </span>
                    </div>
                </div>
                <div>
                    <p class="text-sm text-gray-600 mb-4">Tabelul este gata. Faceți clic pe "Copiază Tabelul" și lipiți-l direct în e-mailul dumneavoastră.</p>
                    <div id="table-output-id" class="shadow-lg rounded-lg border border-black overflow-hidden">
                        <!-- La tabla ID se insertará aquí -->
                    </div>
                </div>
            </div>
            <!-- Fin Contenedor de Salida de Tabla ID -->
        </div>
        <!-- Fin Contenedor Oculto ID -->

<!-- v42.0: Contenedor Oculto para Formulario 6 (Conformal Defects) -->
        <div id="form-container-cd" class="form-container">
            
            <h2 class="text-2xl font-bold text-gray-800 mb-4 border-b pb-2">Formular: Conformal Defects</h2>

            <!-- Formulario de Entrada de Datos 6 (ID) -->
            <!-- Formulario de Entrada de Datos 6 (ID) - v43.0 Actualizado -->
            <form id="data-form-cd" class="space-y-6" novalidate>

                <!-- v42.0: Opciones de Select actualizadas para Insertion Defects -->
                <div class="md:col-span-2">
                    <label for="cd_selectDefect" class="block text-sm font-medium text-gray-700">Select Conformal Defect<span class="text-red-500 ml-1">*</span></label>
                    <select id="cd_selectDefect" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        <option value="">Selectați...</option>
                        <option value="Lack Of Coating Coverage (LOC)">Lack Of Coating Coverage (LOC)</option>
                        <option value="Keep Out Zone Violation (KOZ)">Keep Out Zone Violation (KOZ)</option>
                        <option value="Encapsulated Debris (DEB)">Encapsulated Debris (DEB)</option>
                        <option value="Dewetting (DEW)">Dewetting (DEW)</option>
                        <option value="Blisters, Voids, Bubbles (BVB)">Blisters, Voids, Bubbles (BVB)</option>
                        <option value="Excessive Coating (EXC)">Excessive Coating (EXC)</option>
                        <option value="Lifting Of Coating (LFT)">Lifting Of Coating (LFT)</option>
                        <option value="Ripples, Wrinkles, Orange Peel (RWO)">Ripples, Wrinkles, Orange Peel (RWO)</option>
                        <option value="Thickness Violation (THI)">Thickness Violation (THI)</option>
                        <option value="Soft / Tacky Coating (TAC)">Soft / Tacky Coating (TAC)</option>
                    </select>
                </div>

                <!-- Sección 1: Problem Description (ID) -->
                <div>
                    <h2 class="text-xl font-semibold text-indigo-700 border-b pb-2 mb-4">Secțiunea 1: Problem Description</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4">
                        <div class="md:col-span-2">
                            <label for="cd_pdPCBA_PN" class="block text-sm font-medium text-gray-700">PCBA Part Number<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="cd_pdPCBA_PN" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                        <div class="md:col-span-2">
                            <label for="cd_pdComponent_PN" class="block text-sm font-medium text-gray-700">Component Part Number<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="cd_pdComponent_PN" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                        <div class="md:col-span-2">
                            <label for="cd_pdSideAffected" class="block text-sm font-medium text-gray-700">Side Affected<span class="text-red-500 ml-1">*</span></label>
                            <select id="cd_pdSideAffected" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                                <option value="">Selectați...</option>
                                <option value="A">Side A</option>
                                <option value="B">Side B</option>
                                <option value="A+B">Side A + Side B</option>
                            </select>
                        </div>
                        <div>
                            <label for="cd_pdUsageSideA" class="block text-sm font-medium text-gray-700">Usage / Side (A)<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="cd_pdUsageSideA" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                        <div>
                            <label for="cd_pdUsageSideB" class="block text-sm font-medium text-gray-700">Usage / Side (B)<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="cd_pdUsageSideB" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                        <div>
                            <label for="cd_pdRefDesA" class="block text-sm font-medium text-gray-700">Ref. des. (A)<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="cd_pdRefDesA" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                         <div>
                            <label for="cd_pdRefDesB" class="block text-sm font-medium text-gray-700">Ref. des. (B)<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="cd_pdRefDesB" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                        <div>
                            <label for="cd_pdLine" class="block text-sm font-medium text-gray-700">Line<span class="text-red-500 ml-1">*</span></label>
                             <select id="cd_pdLine" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                                <option value="">Selectați...</option>
                                <option value="Conformal Coating 2 (CC2)">Conformal Coating 2 (CC2)</option>
                                <option value="Conformal Coating 3 (CC3)">Conformal Coating 3 (CC3)</option>
                                <option value="Conformal Coating 4 (CC4)">Conformal Coating 4 (CC4)</option>
                                <option value="Conformal Coating 5 (CC5)">Conformal Coating 5 (CC5)</option>
                                <option value="Conformal Coating 8 (CC8)">Conformal Coating 8 (CC8)</option>
                                <option value="Conformal Coating 9 (CC9)">Conformal Coating 9 (CC9)</option>
                                <option value="Conformal Coating 10 (CC10)">Conformal Coating 10 (CC10)</option>
                            </select>
                        </div>
                        <div>
                            <label for="cd_pdWorkOrder" class="block text-sm font-medium text-gray-700">Work Order<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="cd_pdWorkOrder" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                        <div>
                            <label for="cd_pdWO_QTY" class="block text-sm font-medium text-gray-700">WO QTY<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="cd_pdWO_QTY" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                        <div>
                            <label for="cd_pdDateShift" class="block text-sm font-medium text-gray-700">Date / Shift<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="cd_pdDateShift" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                    </div>
                </div>
                <!-- Sección 2: Containment (ID) -->
                <div>
                    <h2 class="text-xl font-semibold text-yellow-600 border-b pb-2 mb-4">Secțiunea 2: Containment</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4">
                        <div>
                            <label for="cd_contCommonProcess" class="block text-sm font-medium text-gray-700">Common processes (WIP)<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="cd_contCommonProcess" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                        <div>
                            <label for="cd_contCFTLine" class="block text-sm font-medium text-gray-700">CFT line (MPF)<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="cd_contCFTLine" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                        <div>
                            <label for="cd_contTotalQTY" class="block text-sm font-medium text-gray-700">Total affected QTY<span class="text-red-500 ml-1">*</span></label>
                            <input type="text" id="cd_contTotalQTY" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                        <div>
                            <label for="cd_contAllAffectedSN" class="block text-sm font-medium text-gray-700">All affected S/N was sent to Fix?<span class="text-red-500 ml-1">*</span></label>
                             <input type="text" id="cd_contAllAffectedSN" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        </div>
                    </div>
                </div>
                
                <!-- v43.0: Sección re-numerada a 6 -->
                <div>
                    <h2 class="text-xl font-semibold text-gray-700 border-b pb-2 mb-4">Secțiunea 3: Root Cause</h2>
                    <div>
                        <label for="cd_rootCause" class="block text-sm font-medium text-gray-700">Descriere Root Cause<span class="text-red-500 ml-1">*</span></label>
                        <textarea id="cd_rootCause" rows="4" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required></textarea>
                    </div>
                </div>
                <!-- v43.0: Sección re-numerada a 7 -->
                <div>
                    <h2 class="text-xl font-semibold text-purple-700 border-b pb-2 mb-4">Secțiunea 4: Corrective Actions</h2>
                    <div>
                        <label for="cd_correctiveActions" class="block text-sm font-medium text-gray-700">Descriere Corrective Actions<span class="text-red-500 ml-1">*</span></label>
                        <textarea id="cd_correctiveActions" rows="4" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required></textarea>
                    </div>
                </div>

                <!-- Div de Notificación de Error -->
                <div id="error-notification-cd" class="hidden p-4 mb-4 text-sm text-red-800 bg-red-100 rounded-lg" role="alert"></div>
                <!-- Botón de Generar -->
                <div class="pt-6 border-t">
                    <button type="submit" class="w-full bg-indigo-600 text-white font-bold py-3 px-6 rounded-lg shadow-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition-all duration-150">
                        Generează Tabelul (CD)
                    </button>
                </div>
            </form>
            <!-- Contenedor de Salida de Tabla (ID) -->
            <div id="output-container-cd" class="mt-12" style="display: none;">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-2xl font-bold text-gray-800">Tabelul Generat (ID)</h2>
                    <div class="relative">
                        <button id="copy-btn-cd" class="bg-green-600 text-white text-xs font-bold py-2 px-4 rounded-md hover:bg-green-700 transition-all duration-150">
                            Copiază Tabelul
                        </button>
                        <span id="copy-notification-cd" class="absolute top-0 left-full ml-4 bg-gray-800 text-white text-xs font-bold py-2 px-3 rounded-md opacity-0 whitespace-nowrap">
                            Copiata!
                        </span>
                    </div>
                </div>
                <div>
                    <p class="text-sm text-gray-600 mb-4">Tabelul este gata. Faceți clic pe "Copiază Tabelul" și lipiți-l direct în e-mailul dumneavoastră.</p>
                    <div id="table-output-cd" class="shadow-lg rounded-lg border border-black overflow-hidden">
                        <!-- La tabla ID se insertará aquí -->
                    </div>
                </div>
            </div>
            <!-- Fin Contenedor de Salida de Tabla CD -->

<!-- v45.0: Contenedor Oculto para Formulario 7 (Poze AOI / SPI / X-Ray / AAD) -->
<div id="form-container-poze" class="form-container">
    
    <!-- Título dinámico del formulario -->
    <h2 id="form-title-poze" class="text-2xl font-bold text-gray-800 mb-4 border-b pb-2">Formular: Poze AOI / SPI / X-Ray / AAD</h2>

    <!-- Formulario de Entrada de Datos 7 (Poze) - Inspirado en MSL -->
    <form id="data-form-poze" class="space-y-6" novalidate>

        <!-- Sección 1: Date (Poze) -->
        <div>
            <h2 class="text-xl font-semibold text-indigo-700 border-b pb-2 mb-4">Secțiunea 1: Date</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4">
                
                <!-- Campo 1: Selector dinámico -->
                <div class="md:col-span-2">
                    <label for="poze_selectType" class="block text-sm font-medium text-gray-700">Select Type<span class="text-red-500 ml-1">*</span></label>
                    <select id="poze_selectType" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        <option value="">Selectați...</option>
                        <option value="Poze AOI">Poze AOI</option>
                        <option value="Poze SPI">Poze SPI</option>
                        <option value="Poze X-Ray">Poze X-Ray</option>
                        <option value="Poze AAD">Poze AAD</option>
                    </select>
                </div>
                
                <!-- Campo 2: Part Number -->
                <div class="md:col-span-2">
                    <label for="poze_partNumber" class="block text-sm font-medium text-gray-700">Part Number<span class="text-red-500 ml-1">*</span></label>
                    <input type="text" id="poze_partNumber" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                </div>
                
                <!-- Campo 3: Work Order -->
                <div>
                    <label for="poze_workOrder" class="block text-sm font-medium text-gray-700">Work Order<span class="text-red-500 ml-1">*</span></label>
                    <input type="text" id="poze_workOrder" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                </div>
                
                <!-- Campo 4: Date work order -->
                <div>
                    <label for="poze_dateWorkOrder" class="block text-sm font-medium text-gray-700">Date work order<span class="text-red-500 ml-1">*</span></label>
                    <input type="text" id="poze_dateWorkOrder" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                </div>

                <!-- Campo 5: Serial Number -->
                <div class="md:col-span-2">
                    <label for="poze_serialNumber" class="block text-sm font-medium text-gray-700">Serial Number<span class="text-red-500 ml-1">*</span></label>
                    <input type="text" id="poze_serialNumber" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                </div>
                <!-- Campo 6: Reference -->
                <div class="md:col-span-2">
                    <label for="poze_reference" class="block text-sm font-medium text-gray-700">Reference / References<span class="text-red-500 ml-1">*</span></label>
                    <input type="text" id="poze_reference" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                </div>

                <!-- Campo 7: Side -->
                <div>
                    <label for="poze_side" class="block text-sm font-medium text-gray-700">Side<span class="text-red-500 ml-1">*</span></label>
                    <select id="poze_side" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                        <option value="">Selectați...</option>
                        <option value="A">Side A</option>
                        <option value="B">Side B</option>
                        <option value="A+B">Side A + Side B</option>
                    </select>
                </div>
                
                <!-- Campo 8: Line/ EIN machine -->
                <div>
                    <label for="poze_lineMachine" class="block text-sm font-medium text-gray-700">Line/ EIN machine<span class="text-red-500 ml-1">*</span></label>
                    <input type="text" id="poze_lineMachine" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                </div>
            </div>
        </div>

        <!-- Div de Notificación de Error -->
        <div id="error-notification-poze" class="hidden p-4 mb-4 text-sm text-red-800 bg-red-100 rounded-lg" role="alert"></div>
        
        <!-- Botón de Generar -->
        <div class="pt-6 border-t">
            <button type="submit" class="w-full bg-indigo-600 text-white font-bold py-3 px-6 rounded-lg shadow-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition-all duration-150">
                Generează Tabelul (Poze)
            </button>
        </div>
    </form>
    
    <!-- Contenedor de Salida de Tabla (Poze) -->
    <div id="output-container-poze" class="mt-12" style="display: none;">
        <div class="flex justify-between items-center mb-4">
            <!-- Título dinámico de la tabla -->
            <h2 id="table-title-poze" class="text-2xl font-bold text-gray-800">Tabelul Generat</h2>
            <div class="relative">
                <button id="copy-btn-poze" class="bg-green-600 text-white text-xs font-bold py-2 px-4 rounded-md hover:bg-green-700 transition-all duration-150">
                    Copiază Tabelul
                </button>
                <span id="copy-notification-poze" class="absolute top-0 left-full ml-4 bg-gray-800 text-white text-xs font-bold py-2 px-3 rounded-md opacity-0 whitespace-nowrap">
                    Copiata!
                </span>
            </div>
        </div>
        <div>
            <p class="text-sm text-gray-600 mb-4">Tabelul este gata. Faceți clic pe "Copiază Tabelul" și lipiți-l direct în e-mailul dumneavoastră.</p>
            <div id="table-output-poze" class="shadow-lg rounded-lg border border-black overflow-hidden">
                <!-- La tabla Poze se insertará aquí -->
            </div>
        </div>
    </div>
    <!-- Fin Contenedor de Salida de Tabla Poze -->
</div>
<!-- Fin Contenedor Oculto Poze -->

<!-- v46.0: Contenedor Oculto para Formulario 8 (Capat de Rola) -->
<div id="form-container-cr" class="form-container">
    
    <h2 id="form-title-cr" class="text-2xl font-bold text-gray-800 mb-4 border-b pb-2">Formular: Capat de Rola P/N Gresit</h2>

    <!-- Formulario de Entrada de Datos 8 (CR) - Inspirado en Poze/MSL -->
    <form id="data-form-cr" class="space-y-6" novalidate>

        <!-- Sección 1: Date (CR) -->
        <div>
            <h2 class="text-xl font-semibold text-indigo-700 border-b pb-2 mb-4">Secțiunea 1: Date</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4">
                
                <!-- Campo 1: Problem Statement -->
                <div class="md:col-span-2">
                    <label for="cr_problemStatement" class="block text-sm font-medium text-gray-700">Problem Statement<span class="text-red-500 ml-1">*</span></label>
                    <textarea id="cr_problemStatement" rows="3" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required></textarea>
                </div>
                
                <!-- Campo 2: PN PCBA -->
                <div>
                    <label for="cr_pnPcba" class="block text-sm font-medium text-gray-700">PN PCBA<span class="text-red-500 ml-1">*</span></label>
                    <input type="text" id="cr_pnPcba" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                </div>
                
                <!-- Campo 3: PN Component -->
                <div>
                    <label for="cr_pnComponent" class="block text-sm font-medium text-gray-700">PN Component<span class="text-red-500 ml-1">*</span></label>
                    <input type="text" id="cr_pnComponent" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                </div>

                <!-- Campo 4: MPN Component -->
                <div>
                    <label for="cr_mpnComponent" class="block text-sm font-medium text-gray-700">MPN Component<span class="text-red-500 ml-1">*</span></label>
                    <input type="text" id="cr_mpnComponent" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                </div>

                <!-- Campo 5: LP -->
                <div>
                    <label for="cr_lp" class="block text-sm font-medium text-gray-700">LP<span class="text-red-500 ml-1">*</span></label>
                    <input type="text" id="cr_lp" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                </div>
                
                <!-- Campo 6: Quantity of LP -->
                <div>
                    <label for="cr_qtyLp" class="block text-sm font-medium text-gray-700">Quantity of LP<span class="text-red-500 ml-1">*</span></label>
                    <input type="text" id="cr_qtyLp" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                </div>

                <!-- Campo 7: P/N gresit identificat la -->
                <div>
                    <label for="cr_identificatLa" class="block text-sm font-medium text-gray-700">P/N gresit identificat la<span class="text-red-500 ml-1">*</span></label>
                    <input type="text" id="cr_identificatLa" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                </div>
            </div>
        </div>

        <!-- Div de Notificación de Error -->
        <div id="error-notification-cr" class="hidden p-4 mb-4 text-sm text-red-800 bg-red-100 rounded-lg" role="alert"></div>
        
        <!-- Botón de Generar -->
        <div class="pt-6 border-t">
            <button type="submit" class="w-full bg-indigo-600 text-white font-bold py-3 px-6 rounded-lg shadow-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition-all duration-150">
                Generează Tabelul (Capat de Rola)
            </button>
        </div>
    </form>
    
    <!-- Contenedor de Salida de Tabla (CR) -->
    <div id="output-container-cr" class="mt-12" style="display: none;">
        <div class="flex justify-between items-center mb-4">
            <!-- Título estático de la tabla -->
            <h2 id="table-title-cr" class="text-2xl font-bold text-gray-800">Tabelul Generat (Capat de Rola)</h2>
            <div class="relative">
                <button id="copy-btn-cr" class="bg-green-600 text-white text-xs font-bold py-2 px-4 rounded-md hover:bg-green-700 transition-all duration-150">
                    Copiază Tabelul
                </button>
                <span id="copy-notification-cr" class="absolute top-0 left-full ml-4 bg-gray-800 text-white text-xs font-bold py-2 px-3 rounded-md opacity-0 whitespace-nowrap">
                    Copiata!
                </span>
            </div>
        </div>
        <div>
            <p class="text-sm text-gray-600 mb-4">Tabelul este gata. Faceți clic pe "Copiază Tabelul" și lipiți-l direct în e-mailul dumneavoastră.</p>
            <div id="table-output-cr" class="shadow-lg rounded-lg border border-black overflow-hidden">
                <!-- La tabla CR se insertará aquí -->
            </div>
        </div>
    </div>
    <!-- Fin Contenedor de Salida de Tabla CR -->
</div>
<!-- Fin Contenedor Oculto CR -->

<!-- v50.0: Contenedor Oculto para Formulario 9 (Defecte Etichete) -->
<div id="form-container-de" class="form-container">
    
    <h2 id="form-title-de" class="text-2xl font-bold text-gray-800 mb-4 border-b pb-2">Formular: Defecte Etichete</h2>

    <!-- Formulario de Entrada de Datos 9 (DE) - Inspirado en Wrong Process SMT -->
    <form id="data-form-de" class="space-y-6" novalidate>

        <!-- Campo 1: Selector dinámico -->
        <div class="md:col-span-2">
            <label for="de_selectDefect" class="block text-sm font-medium text-gray-700">Defect Type<span class="text-red-500 ml-1">*</span></label>
            <select id="de_selectDefect" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                <option value="">Selectați...</option>
                <option value="Wrong Information on Label">Wrong Information on Label</option>
                <option value="Illegible or Misprinted Information on Label">Illegible or Misprinted Information on Label</option>
                <option value="Wrong Placement of Label">Wrong Placement of Label</option>
                <option value="Damaged Label">Damaged Label</option>
                <option value="Bar-Code Label Not Scannable or Readable">Bar-Code Label Not Scannable or Readable</option>
            </select>
        </div>

        <!-- Sección 1: QT Technician (DE) -->
        <div>
            <h2 class="text-xl font-semibold text-indigo-700 border-b pb-2 mb-4">Secțiunea 1: QT Technician</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4">
                <div class="md:col-span-2">
                    <label for="de_qtModelPart" class="block text-sm font-medium text-gray-700">Model Part Number<span class="text-red-500 ml-1">*</span></label>
                    <input type="text" id="de_qtModelPart" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                </div>
                <div>
                    <label for="de_qtWoAffected" class="block text-sm font-medium text-gray-700">Work Order Affected<span class="text-red-500 ml-1">*</span></label>
                    <input type="text" id="de_qtWoAffected" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                </div>
                <div>
                    <label for="de_qtWoQty" class="block text-sm font-medium text-gray-700">Work Order QTY<span class="text-red-500 ml-1">*</span></label>
                    <input type="text" id="de_qtWoQty" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                </div>
                <div class="md:col-span-2">
                    <label for="de_qtDateShift" class="block text-sm font-medium text-gray-700">Date / Shift<span class="text-red-500 ml-1">*</span></label>
                    <input type="text" id="de_qtDateShift" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                </div>
            </div>
        </div>
        <!-- Sección 2: Test Inspection AOI (DE) -->
        <div>
            <h2 class="text-xl font-semibold text-indigo-700 border-b pb-2 mb-4">Secțiunea 2: Test Inspection AOI</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4">
                <div>
                    <label for="de_aoiLabelDefect" class="block text-sm font-medium text-gray-700">Label Defect on AOI Photos ?<span class="text-red-500 ml-1">*</span></label>
                    <input type="text" id="de_aoiLabelDefect" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                </div>
                <div>
                    <label for="de_aoiPhotos" class="block text-sm font-medium text-gray-700">IF YES - Link To Photos<span class="text-red-500 ml-1">*</span></label>
                    <input type="text" id="de_aoiPhotos" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                </div>
            </div>
        </div>
        <!-- Sección 3: Containment Production / CFT (DE) -->
        <div>
            <h2 class="text-xl font-semibold text-yellow-600 border-b pb-2 mb-4">Secțiunea 3: Containment Production / CFT</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4">
                <div>
                    <label for="de_cftCommonProcess" class="block text-sm font-medium text-gray-700">Common Process (WIP)<span class="text-red-500 ml-1">*</span></label>
                    <input type="text" id="de_cftCommonProcess" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                </div>
                <div>
                    <label for="de_cftLine" class="block text-sm font-medium text-gray-700">CFT Line (MPF)<span class="text-red-500 ml-1">*</span></label>
                    <input type="text" id="de_cftLine" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                </div>
                <div>
                    <label for="de_cftTotalQty" class="block text-sm font-medium text-gray-700">Total QTY Affected<span class="text-red-500 ml-1">*</span></label>
                    <input type="text" id="de_cftTotalQty" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                </div>
                <div>
                    <label for="de_cftAllAffectedSN" class="block text-sm font-medium text-gray-700">All Affected (S/N) Serial Numbers Was Sent To Fix?<span class="text-red-500 ml-1">*</span></label>
                    <input type="text" id="de_cftAllAffectedSN" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                </div>
            </div>
        </div>
        <!-- Sección 4: Root Cause (DE) -->
        <div>
            <h2 class="text-xl font-semibold text-gray-700 border-b pb-2 mb-4">Secțiunea 4: Root Cause</h2>
            <div class="space-y-4">
                <div>
                    <label for="de_rcFormCompleted" class="block text-sm font-medium text-gray-700">Form #1461 or #1593-01 completed and Verified by QT?<span class="text-red-500 ml-1">*</span></label>
                    <input type="text" id="de_rcFormCompleted" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required>
                </div>
                <div>
                    <label for="de_rcDetails" class="block text-sm font-medium text-gray-700">Root Cause Details<span class="text-red-500 ml-1">*</span></label>
                    <textarea id="de_rcDetails" rows="4" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required></textarea>
                </div>
            </div>
        </div>
        <!-- Sección 5: Corrective Actions (DE) -->
        <div>
            <h2 class="text-xl font-semibold text-green-700 border-b pb-2 mb-4">Secțiunea 5: Corrective Actions</h2>
            <div>
                <label for="de_correctiveActions" class="block text-sm font-medium text-gray-700">Descriere Corrective Actions<span class="text-red-500 ml-1">*</span></label>
                <textarea id="de_correctiveActions" rows="4" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 py-2 px-3" required></textarea>
            </div>
        </div>

        <!-- Div de Notificación de Error -->
        <div id="error-notification-de" class="hidden p-4 mb-4 text-sm text-red-800 bg-red-100 rounded-lg" role="alert"></div>
        
        <!-- Botón de Generar -->
        <div class="pt-6 border-t">
            <button type="submit" class="w-full bg-indigo-600 text-white font-bold py-3 px-6 rounded-lg shadow-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition-all duration-150">
                Generează Tabelul (Defecte Etichete)
            </button>
        </div>
    </form>
    
    <!-- Contenedor de Salida de Tabla (DE) -->
    <div id="output-container-de" class="mt-12" style="display: none;">
        <div class="flex justify-between items-center mb-4">
            <h2 id="table-title-de" class="text-2xl font-bold text-gray-800">Tabelul Generat</h2>
            <div class="relative">
                <button id="copy-btn-de" class="bg-green-600 text-white text-xs font-bold py-2 px-4 rounded-md hover:bg-green-700 transition-all duration-150">
                    Copiază Tabelul
                </button>
                <span id="copy-notification-de" class="absolute top-0 left-full ml-4 bg-gray-800 text-white text-xs font-bold py-2 px-3 rounded-md opacity-0 whitespace-nowrap">
                    Copiata!
                </span>
            </div>
        </div>
        <div>
            <p class="text-sm text-gray-600 mb-4">Tabelul este gata. Faceți clic pe "Copiază Tabelul" și lipiți-l direct în e-mailul dumneavoastră.</p>
            <div id="table-output-de" class="shadow-lg rounded-lg border border-black overflow-hidden">
                <!-- La tabla DE se insertará aquí -->
            </div>
        </div>
    </div>
    <!-- Fin Contenedor de Salida de Tabla DE -->
</div>
<!-- Fin Contenedor Oculto DE -->


    </div>

    <!-- INICIO DEL SCRIPT -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            
            // --- v38.0: Controladores de visibilidad para CINCO formularios ---
            const showFormBtnWPN = document.getElementById('show-form-btn-wpn');
            const formContainerWPN = document.getElementById('form-container-wpn');
            
            const showFormBtnWP = document.getElementById('show-form-btn-wp');
            const formContainerWP = document.getElementById('form-container-wp');
            
            const showFormBtnWO = document.getElementById('show-form-btn-wo');
            const formContainerWO = document.getElementById('form-container-wo');

            const showFormBtnMSL = document.getElementById('show-form-btn-msl');
            const formContainerMSL = document.getElementById('form-container-msl');

            const showFormBtnWPS = document.getElementById('show-form-btn-wps');
            const formContainerWPS = document.getElementById('form-container-wps');
	    // v42.0: Constantes para Insertion Defects
            const showFormBtnID = document.getElementById('show-form-btn-id');
            const formContainerID = document.getElementById('form-container-id');
            const showFormBtnCD = document.getElementById('show-form-btn-cd');
            const formContainerCD = document.getElementById('form-container-cd');
// v45.0: Constantes para Poze (AÑADIR ESTAS DOS LÍNEAS)
        const showFormBtnPOZE = document.getElementById('show-form-btn-poze');
        const formContainerPOZE = document.getElementById('form-container-poze');
const showFormBtnCR = document.getElementById('show-form-btn-cr');
        const formContainerCR = document.getElementById('form-container-cr');
const showFormBtnDE = document.getElementById('show-form-btn-de');
        const formContainerDE = document.getElementById('form-container-de');
            // Función genérica para ocultar todos los formularios
            function hideAllForms() {
                formContainerWPN.classList.remove('visible');
                formContainerWP.classList.remove('visible');
                formContainerWO.classList.remove('visible');
                formContainerMSL.classList.remove('visible');
                formContainerWPS.classList.remove('visible');
                formContainerID.classList.remove('visible');
                formContainerPOZE.classList.remove('visible');
                formContainerCR.classList.remove('visible');
                formContainerDE.classList.remove('visible'); // v42.0: Añadido
                formContainerCD.classList.remove('visible');
            }

// Función genérica para manejar el clic del botón
            function setupFormToggle(button, container) {
                if (!button) return;
                
                // v44.0: Busca el contenedor de botones UNA SOLA VEZ
                const buttonContainer = document.getElementById('button-sections-container');

                button.addEventListener('click', () => {
                    // v44.0: Comprueba el estado ANTES de hacer nada
                    const isAlreadyVisible = container.classList.contains('visible');

                    hideAllForms(); // Oculta todos los formularios

                    if (!isAlreadyVisible) {
                        // Si estaba oculto (y no era el que acabamos de cerrar), ábrelo
                        container.classList.add('visible');
                    }
                    // Si ya estaba visible, hideAllForms() ya lo cerró.
                    
                    // v44.0: En CUALQUIER CASO (abrir o cerrar), haz scroll a la sección de botones.
                    if (buttonContainer) {
                         // Damos 50ms para que el DOM se actualice (si se abre un form)
                        setTimeout(() => buttonContainer.scrollIntoView({ behavior: 'smooth', block: 'start' }), 50);
                    }
                });
            }

            setupFormToggle(showFormBtnWPN, formContainerWPN);
            setupFormToggle(showFormBtnWP, formContainerWP);
            setupFormToggle(showFormBtnWO, formContainerWO);
            setupFormToggle(showFormBtnMSL, formContainerMSL);
            setupFormToggle(showFormBtnWPS, formContainerWPS); // v38.0: Añadido
	    setupFormToggle(showFormBtnID, formContainerID); // v42.0: Añadido
            setupFormToggle(showFormBtnCD, formContainerCD);
            setupFormToggle(showFormBtnPOZE, formContainerPOZE);
            setupFormToggle(showFormBtnCR, formContainerCR);
            setupFormToggle(showFormBtnDE, formContainerDE);


            // --- INICIO: Lógica para Formulario 1 (Wrong Part Number) ---
            function setupFormWPN() {
                const form = document.getElementById('data-form-wpn');
                if (!form) return; 
                const outputContainer = document.getElementById('output-container-wpn');
                const copyBtn = document.getElementById('copy-btn-wpn');
                const copyNotification = document.getElementById('copy-notification-wpn');
                const tableOutput = document.getElementById('table-output-wpn');
                const errorDiv = document.getElementById('error-notification-wpn');

                const sideAffectedSelect = document.getElementById('wpn_qtSideAffected');
                const usageSideA = document.getElementById('wpn_qtUsageSideA');
                const usageSideB = document.getElementById('wpn_qtUsageSideB');
                const refAffectedA = document.getElementById('wpn_qtRefAffectedA');
                const refAffectedB = document.getElementById('wpn_qtRefAffectedB');

                sideAffectedSelect.addEventListener('change', (e) => {
                    const selection = e.target.value;
                    const fields = [usageSideA, usageSideB, refAffectedA, refAffectedB];
                    fields.forEach(field => {
                        field.disabled = false;
                        field.required = true;
                        field.value = '';
                    });
                    if (selection === 'A') {
                        [usageSideB, refAffectedB].forEach(f => { f.value = 'N/A'; f.disabled = true; f.required = false; });
                    } else if (selection === 'B') {
                        [usageSideA, refAffectedA].forEach(f => { f.value = 'N/A'; f.disabled = true; f.required = false; });
                    }
                });

                form.addEventListener('submit', (e) => {
                    e.preventDefault();
                    if (!form.checkValidity()) {
                        let firstInvalidField = form.querySelector(':invalid');
                        let labelText = 'un câmp';
                        if(firstInvalidField) {
                             let label = document.querySelector(`label[for='${firstInvalidField.id}']`);
                             if(label) labelText = label.firstChild.textContent.trim();
                        }
                        errorDiv.textContent = `Vă rugăm să completați câmpul obligatoriu: "${labelText}".`;
                        errorDiv.classList.remove('hidden');
                        if(firstInvalidField) firstInvalidField.focus();
                        errorDiv.scrollIntoView({ behavior: 'smooth', block: 'center' });
                        return;
                    }
                    errorDiv.classList.add('hidden');

                    const data = {
                        qtModelPart: document.getElementById('wpn_qtModelPart').value || '&nbsp;',
                        qtComponentPart: document.getElementById('wpn_qtComponentPart').value || '&nbsp;',
                        qtUsageSideA: document.getElementById('wpn_qtUsageSideA').value || '&nbsp;',
                        qtUsageSideB: document.getElementById('wpn_qtUsageSideB').value || '&nbsp;',
                        qtRefAffectedA: document.getElementById('wpn_qtRefAffectedA').value || '&nbsp;',
                        qtRefAffectedB: document.getElementById('wpn_qtRefAffectedB').value || '&nbsp;',
                        qtShape: document.getElementById('wpn_qtShape').value || '&nbsp;',
                        qtLineAffected: document.getElementById('wpn_qtLineAffected').value || '&nbsp;',
                        qtWoAffected: document.getElementById('wpn_qtWoAffected').value || '&nbsp;',
                        qtWoQty: document.getElementById('wpn_qtWoQty').value || '&nbsp;',
                        qtDateShift: document.getElementById('wpn_qtDateShift').value || '&nbsp;',
                        aoiFalseCall: document.getElementById('wpn_aoiFalseCall').value || '&nbsp;',
                        aoiPhotos: document.getElementById('wpn_aoiPhotos').value || '&nbsp;',
                        tdCoverage: document.getElementById('wpn_tdCoverage').value || '&nbsp;',
                        llLicensePlate1: document.getElementById('wpn_llLicensePlate1').value || '&nbsp;',
                        llLicensePlate2: document.getElementById('wpn_llLicensePlate2').value || '&nbsp;',
                        llLicensePlate3: document.getElementById('wpn_llLicensePlate3').value || '&nbsp;',
                        llLicensePlate4: document.getElementById('wpn_llLicensePlate4').value || '&nbsp;',
                        llLicensePlate5: document.getElementById('wpn_llLicensePlate5').value || '&nbsp;',
                        llLicensePlate6: document.getElementById('wpn_llLicensePlate6').value || '&nbsp;',
                        cftCommonProcess: document.getElementById('wpn_cftCommonProcess').value || '&nbsp;',
                        cftLine: document.getElementById('wpn_cftLine').value || '&nbsp;',
                        cftTotalQty: document.getElementById('wpn_cftTotalQty').value || '&nbsp;',
                        cftAllAffectedSN: document.getElementById('wpn_cftAllAffectedSN').value || '&nbsp;',
                        cftContainmentChecks: document.getElementById('wpn_cftContainmentChecks').value || '&nbsp;',
                        ptSiplaceErrors: document.getElementById('wpn_ptSiplaceErrors').value || '&nbsp;',
                        rootCause: document.getElementById('wpn_rootCause').value.replace(/\n/g, '<br>') || '&nbsp;',
                        correctiveActions: document.getElementById('wpn_correctiveActions').value.replace(/\n/g, '<br>') || '&nbsp;'
                    };

                    const baseCell = "p-2 border border-gray-300 align-middle text-center";
                    const baseLabel = `${baseCell} bg-gray-50 text-gray-700 font-medium`;
                    const baseValue = `${baseCell} text-gray-900 break-words`;
                    const classHeader = "p-3 bg-yellow-200 text-yellow-900 font-bold text-center text-base border border-gray-300";
                    const classSectionQT = `${baseCell} bg-blue-100 text-blue-800 font-semibold w-[20%]`;
                    const classSectionAOI = `${baseCell} bg-cyan-100 text-cyan-800 font-semibold`;
                    const classSectionTD = `${baseCell} bg-green-100 text-green-800 font-semibold`;
                    const classSectionLL = `${baseCell} bg-indigo-100 text-indigo-800 font-semibold`;
                    const classSectionCFT = `${baseCell} bg-yellow-100 text-yellow-800 font-semibold`;
                    const classSectionPT = `${baseCell} bg-red-100 text-red-800 font-semibold`;
                    const classSectionRC = `${baseCell} bg-gray-200 text-gray-800 font-semibold`;
                    const classSectionCA = `${baseCell} bg-purple-100 text-purple-800 font-semibold`;
                    const classLabel = `${baseLabel} w-[21%]`;
                    const classValueSpan = `${baseValue}`; 
                    const classValueA = `${baseValue} w-[25%]`; 
                    const classValueB = `${baseValue} w-[25%]`; 
                    const classValueMulti = `${baseValue} align-top`; 

                    const tableWebHTML = `
                        <table class="text-xs" style="border-collapse: collapse; width: 87%; table-layout: fixed;">
                            <thead>
                                <tr><th colspan="4" class="${classHeader}">Wrong Part Number</th></tr>
                            </thead>
                            <tbody>
                                <!-- Secțiunea 1: QT Technician -->
                                <tr>
                                    <td rowspan="10" class="${classSectionQT}">QT Technician</td>
                                    <td class="${classLabel}" colspan="1">Model Part Number</td>
                                    <td class="${classValueSpan}" colspan="2">${data.qtModelPart}</td>
                                </tr>
                                <tr>
                                    <td class="${classLabel}" colspan="1">Component Part Number</td>
                                    <td class="${classValueSpan}" colspan="2">${data.qtComponentPart}</td>
                                </tr>
                                <tr>
                                    <td class="${classLabel}">Side Affected (A/B)</td>
                                    <td class="${baseLabel} text-center font-bold">A</td>
                                    <td class="${baseLabel} text-center font-bold">B</td>
                                </tr>
                                <tr>
                                    <td class="${classLabel}">Usage / Side</td>
                                    <td class="${classValueA}">${data.qtUsageSideA}</td>
                                    <td class="${classValueB}">${data.qtUsageSideB}</td>
                                </tr>
                                <tr>
                                    <td class="${classLabel}">Reference Affected</td>
                                    <td class="${classValueA}">${data.qtRefAffectedA}</td>
                                    <td class="${classValueB}">${data.qtRefAffectedB}</td>
                                </tr>
                                <tr>
                                    <td class="${classLabel}" colspan="1">Shape / Marking / Value</td>
                                    <td class="${classValueSpan}" colspan="2">${data.qtShape}</td>
                                </tr>
                                <tr>
                                    <td class="${classLabel}" colspan="1">Line Affected</td>
                                    <td class="${classValueSpan}" colspan="2">${data.qtLineAffected}</td>
                                </tr>
                                <tr>
                                    <td class="${classLabel}" colspan="1">Work Order Affected</td>
                                    <td class="${classValueSpan}" colspan="2">${data.qtWoAffected}</td>
                                </tr>
                                <tr>
                                    <td class="${classLabel}" colspan="1">Work Order QTY</td>
                                    <td class="${classValueSpan}" colspan="2">${data.qtWoQty}</td>
                                </tr>
                                <tr>
                                    <td class="${classLabel}" colspan="1">Date / Shift</td>
                                    <td class="${classValueSpan}" colspan="2">${data.qtDateShift}</td>
                                </tr>
                                <!-- Secțiunea 2: Test Inspection AOI -->
                                <tr>
                                    <td rowspan="2" class="${classSectionAOI}">Test Inspection AOI</td>
                                    <td class="${classLabel}" colspan="1">False Call on AOI / GSF ?</td>
                                    <td class="${classValueSpan}" colspan="2">${data.aoiFalseCall}</td>
                                </tr>
                                <tr>
                                    <td class="${classLabel}" colspan="1">IF YES - Link To Photos</td>
                                    <td class="${classValueSpan}" colspan="2">${data.aoiPhotos}</td>
                                </tr>
                                <!-- Secțiunea 3: Test Debug -->
                                <tr>
                                    <td class="${classSectionTD}">Test Debug - ICT / Functional Test</td>
                                    <td class="${classLabel}" colspan="1">We have Coverage on affected References?</td>
                                    <td class="${classValueSpan}" colspan="2">${data.tdCoverage}</td>
                                </tr>
                                <!-- Secțiunea 4: Line Logistics -->
                                <tr>
                                    <td rowspan="3" class="${classSectionLL}">Line Logistics</td>
                                    <td class="${classLabel}" rowspan="3">(LP) License Plate Used / Scanned</td>
                                    <td class="${classValueA}" colspan="1">${data.llLicensePlate1}</td>
                                    <td class="${classValueB}" colspan="1">${data.llLicensePlate4}</td>
                                </tr>
                                <tr>
                                    <td class="${classValueA}" colspan="1">${data.llLicensePlate2}</td>
                                    <td class="${classValueB}" colspan="1">${data.llLicensePlate5}</td>
                                </tr>
                                <tr>
                                    <td class="${classValueA}" colspan="1">${data.llLicensePlate3}</td>
                                    <td class="${classValueB}" colspan="1">${data.llLicensePlate6}</td>
                                </tr>
                                <!-- Secțiunea 5: Containment Production / CFT -->
                                <tr>
                                    <td rowspan="5" class="${classSectionCFT}">Containment Production / CFT</td>
                                    <td class="${classLabel}" colspan="1">Common Process (WIP)</td>
                                    <td class="${classValueSpan}" colspan="2">${data.cftCommonProcess}</td>
                                </tr>
                                <tr>
                                    <td class="${classLabel}" colspan="1">CFT Line (MPF)</td>
                                    <td class="${classValueSpan}" colspan="2">${data.cftLine}</td>
                                </tr>
                                <tr>
                                    <td class="${classLabel}" colspan="1">Total QTY Affected</td>
                                    <td class="${classValueSpan}" colspan="2">${data.cftTotalQty}</td>
                                </tr>
                                <tr>
                                    <td class="${classLabel}" colspan="1">All Affected (S/N) Serial Numbers Was Sent To Fix?</td>
                                    <td class="${classValueSpan}" colspan="2">${data.cftAllAffectedSN}</td>
                                </tr>
                                <tr>
                                    <td class="${classLabel}" colspan="1">Containment Checks</td>
                                    <td class="${classValueSpan}" colspan="2">${data.cftContainmentChecks}</td>
                                </tr>
                                <!-- Secțiunea 6: Process Tech / Engineering -->
                                <tr>
                                    <td class="${classSectionPT}">Process Tech / Engineering</td>
                                    <td class="${classLabel}" colspan="1">Siplace Errors</td>
                                    <td class="${classValueSpan}" colspan="2">${data.ptSiplaceErrors}</td>
                                </tr>
                                <!-- Secțiunea 7: Root Cause -->
                                <tr>
                                    <td class="${classSectionRC}">Root Cause</td>
                                    <td colspan="3" class="${classValueMulti}">${data.rootCause}</td>
                                </tr>
                                <!-- Secțiunea 8: Corrective Actions -->
                                <tr>
                                    <td class="${classSectionCA}">Corrective Actions</td>
                                    <td colspan="3" class="${classValueMulti}">${data.correctiveActions}</td>
                                </tr>
                            </tbody>
                        </table>`;

                    tableOutput.innerHTML = tableWebHTML; 
                    outputContainer.style.display = 'block';
                    outputContainer.scrollIntoView({ behavior: 'smooth' });
                });

                copyBtn.addEventListener('click', () => {
                    try {
                        const range = document.createRange();
                        range.selectNode(tableOutput); 
                        window.getSelection().removeAllRanges();
                        window.getSelection().addRange(range);
                        if (!document.execCommand('copy')) throw new Error('execCommand falló');
                        copyNotification.textContent = 'Copiata!';
                        copyNotification.style.backgroundColor = '#22c55e';
                        copyNotification.style.opacity = '1';
                        setTimeout(() => copyNotification.style.opacity = '0', 2000);
                    } catch (err) {
                        copyNotification.textContent = 'Eroare la copiere';
                        copyNotification.style.backgroundColor = '#ef4444';
                        copyNotification.style.opacity = '1';
                        setTimeout(() => copyNotification.style.opacity = '0', 3000);
                    } finally {
                        window.getSelection().removeAllRanges();
                    }
                });
            }
            // --- FIN: Lógica para Formulario 1 (Wrong Part Number) ---


            // --- INICIO: Lógica para Formulario 2 (Wrong Process) ---
            function setupFormWP() {
                const form = document.getElementById('data-form-wp');
                if (!form) return;
                const outputContainer = document.getElementById('output-container-wp');
                const copyBtn = document.getElementById('copy-btn-wp');
                const copyNotification = document.getElementById('copy-notification-wp');
                const tableOutput = document.getElementById('table-output-wp');
                const errorDiv = document.getElementById('error-notification-wp');

                const sideAffectedSelect = document.getElementById('wp_qtSideAffected');
                const usageSideA = document.getElementById('wp_qtUsageSideA');
                const usageSideB = document.getElementById('wp_qtUsageSideB');
                const refAffectedA = document.getElementById('wp_qtRefAffectedA');
                const refAffectedB = document.getElementById('wp_qtRefAffectedB');

                sideAffectedSelect.addEventListener('change', (e) => {
                    const selection = e.target.value;
                    const fields = [usageSideA, usageSideB, refAffectedA, refAffectedB];
                    fields.forEach(field => {
                        field.disabled = false;
                        field.required = true;
                        field.value = '';
                    });
                    if (selection === 'A') {
                        [usageSideB, refAffectedB].forEach(f => { f.value = 'N/A'; f.disabled = true; f.required = false; });
                    } else if (selection === 'B') {
                        [usageSideA, refAffectedA].forEach(f => { f.value = 'N/A'; f.disabled = true; f.required = false; });
                    }
                });

                form.addEventListener('submit', (e) => {
                    e.preventDefault();
                    if (!form.checkValidity()) {
                        let firstInvalidField = form.querySelector(':invalid');
                        let labelText = 'un câmp';
                        if(firstInvalidField) {
                             let label = document.querySelector(`label[for='${firstInvalidField.id}']`);
                             if(label) labelText = label.firstChild.textContent.trim();
                        }
                        errorDiv.textContent = `Vă rugăm să completați câmpul obligatoriu: "${labelText}".`;
                        errorDiv.classList.remove('hidden');
                        if(firstInvalidField) firstInvalidField.focus();
                        errorDiv.scrollIntoView({ behavior: 'smooth', block: 'center' });
                        return;
                    }
                    errorDiv.classList.add('hidden');

                    const data = {
                        selectProcess: document.getElementById('wp_selectProcess').value || 'Defect',
                        qtModelPart: document.getElementById('wp_qtModelPart').value || '&nbsp;',
                        qtComponentPart: document.getElementById('wp_qtComponentPart').value || '&nbsp;',
                        qtUsageSideA: document.getElementById('wp_qtUsageSideA').value || '&nbsp;',
                        qtUsageSideB: document.getElementById('wp_qtUsageSideB').value || '&nbsp;',
                        qtRefAffectedA: document.getElementById('wp_qtRefAffectedA').value || '&nbsp;',
                        qtRefAffectedB: document.getElementById('wp_qtRefAffectedB').value || '&nbsp;',
                        qtLineAffected: document.getElementById('wp_qtLineAffected').value || '&nbsp;',
                        qtWoAffected: document.getElementById('wp_qtWoAffected').value || '&nbsp;',
                        qtWoQty: document.getElementById('wp_qtWoQty').value || '&nbsp;',
                        qtDateShift: document.getElementById('wp_qtDateShift').value || '&nbsp;',
                        aoiFalseCall: document.getElementById('wp_aoiFalseCall').value || '&nbsp;',
                        aoiPhotos: document.getElementById('wp_aoiPhotos').value || '&nbsp;',
                        spiFalseCall: document.getElementById('wp_spiFalseCall').value || '&nbsp;',
                        spiPhotos: document.getElementById('wp_spiPhotos').value || '&nbsp;',
                        tdCoverage: document.getElementById('wp_tdCoverage').value || '&nbsp;',
                        cftCommonProcess: document.getElementById('wp_cftCommonProcess').value || '&nbsp;',
                        cftLine: document.getElementById('wp_cftLine').value || '&nbsp;',
                        cftTotalQty: document.getElementById('wp_cftTotalQty').value || '&nbsp;',
                        cftAllAffectedSN: document.getElementById('wp_cftAllAffectedSN').value || '&nbsp;',
                        rootCause: document.getElementById('wp_rootCause').value.replace(/\n/g, '<br>') || '&nbsp;',
                        correctiveActions: document.getElementById('wp_correctiveActions').value.replace(/\n/g, '<br>') || '&nbsp;'
                    };

                    const baseCell = "p-2 border border-gray-300 align-middle text-center";
                    const baseLabel = `${baseCell} bg-gray-50 text-gray-700 font-medium`;
                    const baseValue = `${baseCell} text-gray-900 break-words`;
                    const classHeader = "p-3 bg-yellow-200 text-yellow-900 font-bold text-center text-base border border-gray-300";
                    const classSectionQT = `${baseCell} bg-blue-100 text-blue-800 font-semibold w-[20%]`;
                    const classSectionAOI = `${baseCell} bg-cyan-100 text-cyan-800 font-semibold`;
                    const classSectionTD = `${baseCell} bg-green-100 text-green-800 font-semibold`;
                    const classSectionCFT = `${baseCell} bg-yellow-100 text-yellow-800 font-semibold`;
                    const classSectionRC = `${baseCell} bg-gray-200 text-gray-800 font-semibold`;
                    const classSectionCA = `${baseCell} bg-purple-100 text-purple-800 font-semibold`;
                    const classLabel = `${baseLabel} w-[21%]`;
                    const classValueSpan = `${baseValue}`; 
                    const classValueA = `${baseValue} w-[25%]`; 
                    const classValueB = `${baseValue} w-[25%]`; 
                    const classValueMulti = `${baseValue} align-top`; 

                    const tableWebHTML = `
                        <table class="text-xs" style="border-collapse: collapse; width: 87%; table-layout: fixed;">
                            <thead>
                                <tr><th colspan="4" class="${classHeader}">Wrong Process - ${data.selectProcess}</th></tr>
                            </thead>
                            <tbody>
                                <!-- Secțiunea 1: QT Technician (WP) -->
                                <tr>
                                    <td rowspan="9" class="${classSectionQT}">QT Technician</td>
                                    <td class="${classLabel}" colspan="1">Model Part Number</td>
                                    <td class="${classValueSpan}" colspan="2">${data.qtModelPart}</td>
                                </tr>
                                <tr>
                                    <td class="${classLabel}" colspan="1">Component Part Number</td>
                                    <td class="${classValueSpan}" colspan="2">${data.qtComponentPart}</td>
                                </tr>
                                <tr>
                                    <td class="${classLabel}">Side Affected (A/B)</td>
                                    <td class="${baseLabel} text-center font-bold">A</td>
                                    <td class="${baseLabel} text-center font-bold">B</td>
                                </tr>
                                <tr>
                                    <td class="${classLabel}">Usage / Side</td>
                                    <td class="${classValueA}">${data.qtUsageSideA}</td>
                                    <td class="${classValueB}">${data.qtUsageSideB}</td>
                                </tr>
                                <tr>
                                    <td class="${classLabel}">Reference Affected</td>
                                    <td class="${classValueA}">${data.qtRefAffectedA}</td>
                                    <td class="${classValueB}">${data.qtRefAffectedB}</td>
                                </tr>
                                <tr>
                                    <td class="${classLabel}" colspan="1">Line Affected</td>
                                    <td class="${classValueSpan}" colspan="2">${data.qtLineAffected}</td>
                                </tr>
                                <tr>
                                    <td class="${classLabel}" colspan="1">Work Order Affected</td>
                                    <td class="${classValueSpan}" colspan="2">${data.qtWoAffected}</td>
                                </tr>
                                <tr>
                                    <td class="${classLabel}" colspan="1">Work Order QTY</td>
                                    <td class="${classValueSpan}" colspan="2">${data.qtWoQty}</td>
                                </tr>
                                <tr>
                                    <td class="${classLabel}" colspan="1">Date / Shift</td>
                                    <td class="${classValueSpan}" colspan="2">${data.qtDateShift}</td>
                                </tr>
                                <!-- Secțiunea 2: Test Inspection AOI (WP) -->
                                <tr>
                                    <td rowspan="4" class="${classSectionAOI}">Test Inspection AOI</td>
                                    <td class="${classLabel}" colspan="1">False Call on AOI / GSF ?</td>
                                    <td class="${classValueSpan}" colspan="2">${data.aoiFalseCall}</td>
                                </tr>
                                <tr>
                                    <td class="${classLabel}" colspan="1">IF YES - Link To Photos (AOI)</td>
                                    <td class="${classValueSpan}" colspan="2">${data.aoiPhotos}</td>
                                </tr>
                                <tr>
                                    <td class="${classLabel}" colspan="1">False Call on SPI ?</td>
                                    <td class="${classValueSpan}" colspan="2">${data.spiFalseCall}</td>
                                </tr>
                                <tr>
                                    <td class="${classLabel}" colspan="1">IF YES - Link To Photos (SPI)</td>
                                    <td class="${classValueSpan}" colspan="2">${data.spiPhotos}</td>
                                </tr>
                                <!-- Secțiunea 3: Test Debug (WP) -->
                                <tr>
                                    <td class="${classSectionTD}">Test Debug - ICT / Functional Test</td>
                                    <td class="${classLabel}" colspan="1">We have Coverage on affected References?</td>
                                    <td class="${classValueSpan}" colspan="2">${data.tdCoverage}</td>
                                </tr>
                                <!-- Secțiunea 4: Containment Production / CFT (WP) -->
                                <tr>
                                    <td rowspan="4" class="${classSectionCFT}">Containment Production / CFT</td>
                                    <td class="${classLabel}" colspan="1">Common Process (WIP)</td>
                                    <td class="${classValueSpan}" colspan="2">${data.cftCommonProcess}</td>
                                </tr>
                                <tr>
                                    <td class="${classLabel}" colspan="1">CFT Line (MPF)</td>
                                    <td class="${classValueSpan}" colspan="2">${data.cftLine}</td>
                                </tr>
                                <tr>
                                    <td class="${classLabel}" colspan="1">Total QTY Affected</td>
                                    <td class="${classValueSpan}" colspan="2">${data.cftTotalQty}</td>
                                </tr>
                                <tr>
                                    <td class="${classLabel}" colspan="1">All Affected (S/N) Serial Numbers Was Sent To Fix?</td>
                                    <td class="${classValueSpan}" colspan="2">${data.cftAllAffectedSN}</td>
                                </tr>
                                <!-- Secțiunea 5: Root Cause (WP) -->
                                <tr>
                                    <td class="${classSectionRC}">Root Cause</td>
                                    <td colspan="3" class="${classValueMulti}">${data.rootCause}</td>
                                </tr>
                                <!-- Secțiunea 6: Corrective Actions (WP) -->
                                <tr>
                                    <td class="${classSectionCA}">Corrective Actions</td>
                                    <td colspan="3" class="${classValueMulti}">${data.correctiveActions}</td>
                                </tr>
                            </tbody>
                        </table>`;

                    tableOutput.innerHTML = tableWebHTML; 
                    outputContainer.style.display = 'block';
                    outputContainer.scrollIntoView({ behavior: 'smooth' });
                });

                copyBtn.addEventListener('click', () => {
                    try {
                        const range = document.createRange();
                        range.selectNode(tableOutput); 
                        window.getSelection().removeAllRanges();
                        window.getSelection().addRange(range);
                        if (!document.execCommand('copy')) throw new Error('execCommand falló');
                        copyNotification.textContent = 'Copiata!';
                        copyNotification.style.backgroundColor = '#22c55e';
                        copyNotification.style.opacity = '1';
                        setTimeout(() => copyNotification.style.opacity = '0', 2000);
                    } catch (err) {
                        copyNotification.textContent = 'Eroare la copiere';
                        copyNotification.style.backgroundColor = '#ef4444';
                        copyNotification.style.opacity = '1';
                        setTimeout(() => copyNotification.style.opacity = '0', 3000);
                    } finally {
                        window.getSelection().removeAllRanges();
                    }
                });
            }
            // --- FIN: Lógica para Formulario 2 (Wrong Process) ---


            // --- INICIO: Lógica para Formulario 3 (Wrong Orientation) ---
            function setupFormWO() {
                const form = document.getElementById('data-form-wo');
                if (!form) return;
                const outputContainer = document.getElementById('output-container-wo');
                const copyBtn = document.getElementById('copy-btn-wo');
                const copyNotification = document.getElementById('copy-notification-wo');
                const tableOutput = document.getElementById('table-output-wo');
                const errorDiv = document.getElementById('error-notification-wo');

                const sideAffectedSelect = document.getElementById('wo_qtSideAffected');
                const usageSideA = document.getElementById('wo_qtUsageSideA');
                const usageSideB = document.getElementById('wo_qtUsageSideB');
                const refAffectedA = document.getElementById('wo_qtRefAffectedA');
                const refAffectedB = document.getElementById('wo_qtRefAffectedB');

                sideAffectedSelect.addEventListener('change', (e) => {
                    const selection = e.target.value;
                    const fields = [usageSideA, usageSideB, refAffectedA, refAffectedB];
                    fields.forEach(field => {
                        field.disabled = false;
                        field.required = true;
                        field.value = '';
                    });
                    if (selection === 'A') {
                        [usageSideB, refAffectedB].forEach(f => { f.value = 'N/A'; f.disabled = true; f.required = false; });
                    } else if (selection === 'B') {
                        [usageSideA, refAffectedA].forEach(f => { f.value = 'N/A'; f.disabled = true; f.required = false; });
                    }
                });

                form.addEventListener('submit', (e) => {
                    e.preventDefault();
                    if (!form.checkValidity()) {
                        let firstInvalidField = form.querySelector(':invalid');
                        let labelText = 'un câmp';
                        if(firstInvalidField) {
                             let label = document.querySelector(`label[for='${firstInvalidField.id}']`);
                             if(label) labelText = label.firstChild.textContent.trim();
                        }
                        errorDiv.textContent = `Vă rugăm să completați câmpul obligatoriu: "${labelText}".`;
                        errorDiv.classList.remove('hidden');
                        if(firstInvalidField) firstInvalidField.focus();
                        errorDiv.scrollIntoView({ behavior: 'smooth', block: 'center' });
                        return;
                    }
                    errorDiv.classList.add('hidden');

                    const data = {
                        qtModelPart: document.getElementById('wo_qtModelPart').value || '&nbsp;',
                        qtComponentPart: document.getElementById('wo_qtComponentPart').value || '&nbsp;',
                        qtUsageSideA: document.getElementById('wo_qtUsageSideA').value || '&nbsp;',
                        qtUsageSideB: document.getElementById('wo_qtUsageSideB').value || '&nbsp;',
                        qtRefAffectedA: document.getElementById('wo_qtRefAffectedA').value || '&nbsp;',
                        qtRefAffectedB: document.getElementById('wo_qtRefAffectedB').value || '&nbsp;',
                        qtLineAffected: document.getElementById('wo_qtLineAffected').value || '&nbsp;',
                        qtWoAffected: document.getElementById('wo_qtWoAffected').value || '&nbsp;',
                        qtWoQty: document.getElementById('wo_qtWoQty').value || '&nbsp;',
                        qtDateShift: document.getElementById('wo_qtDateShift').value || '&nbsp;',
                        aoiFalseCall: document.getElementById('wo_aoiFalseCall').value || '&nbsp;',
                        aoiPhotos: document.getElementById('wo_aoiPhotos').value || '&nbsp;',
                        tdCoverage: document.getElementById('wo_tdCoverage').value || '&nbsp;',
                        cftCommonProcess: document.getElementById('wo_cftCommonProcess').value || '&nbsp;',
                        cftLine: document.getElementById('wo_cftLine').value || '&nbsp;',
                        cftTotalQty: document.getElementById('wo_cftTotalQty').value || '&nbsp;',
                        cftAllAffectedSN: document.getElementById('wo_cftAllAffectedSN').value || '&nbsp;',
                        ptCheckOrientation: document.getElementById('wo_ptCheckOrientation').value || '&nbsp;',
                        rootCause: document.getElementById('wo_rootCause').value.replace(/\n/g, '<br>') || '&nbsp;',
                        correctiveActions: document.getElementById('wo_correctiveActions').value.replace(/\n/g, '<br>') || '&nbsp;'
                    };

                    const baseCell = "p-2 border border-gray-300 align-middle text-center";
                    const baseLabel = `${baseCell} bg-gray-50 text-gray-700 font-medium`;
                    const baseValue = `${baseCell} text-gray-900 break-words`;
                    const classHeader = "p-3 bg-yellow-200 text-yellow-900 font-bold text-center text-base border border-gray-300";
                    const classSectionQT = `${baseCell} bg-blue-100 text-blue-800 font-semibold w-[20%]`;
                    const classSectionAOI = `${baseCell} bg-cyan-100 text-cyan-800 font-semibold`;
                    const classSectionTD = `${baseCell} bg-green-100 text-green-800 font-semibold`;
                    const classSectionCFT = `${baseCell} bg-yellow-100 text-yellow-800 font-semibold`;
                    const classSectionPT = `${baseCell} bg-red-100 text-red-800 font-semibold`;
                    const classSectionRC = `${baseCell} bg-gray-200 text-gray-800 font-semibold`;
                    const classSectionCA = `${baseCell} bg-purple-100 text-purple-800 font-semibold`;
                    const classLabel = `${baseLabel} w-[21%]`;
                    const classValueSpan = `${baseValue}`; 
                    const classValueA = `${baseValue} w-[25%]`; 
                    const classValueB = `${baseValue} w-[25%]`; 
                    const classValueMulti = `${baseValue} align-top`; 

                    const tableWebHTML = `
                        <table class="text-xs" style="border-collapse: collapse; width: 87%; table-layout: fixed;">
                            <thead>
                                <tr><th colspan="4" class="${classHeader}">Wrong Orientation</th></tr>
                            </thead>
                            <tbody>
                                <!-- Secțiunea 1: QT Technician (WO) -->
                                <tr>
                                    <td rowspan="9" class="${classSectionQT}">QT Technician</td>
                                    <td class="${classLabel}" colspan="1">Model Part Number</td>
                                    <td class="${classValueSpan}" colspan="2">${data.qtModelPart}</td>
                                </tr>
                                <tr>
                                    <td class="${classLabel}" colspan="1">Component Part Number</td>
                                    <td class="${classValueSpan}" colspan="2">${data.qtComponentPart}</td>
                                </tr>
                                <tr>
                                    <td class="${classLabel}">Side Affected (A/B)</td>
                                    <td class="${baseLabel} text-center font-bold">A</td>
                                    <td class="${baseLabel} text-center font-bold">B</td>
                                </tr>
                                <tr>
                                    <td class="${classLabel}">Usage / Side</td>
                                    <td class="${classValueA}">${data.qtUsageSideA}</td>
                                    <td class="${classValueB}">${data.qtUsageSideB}</td>
                                </tr>
                                <tr>
                                    <td class="${classLabel}">Reference Affected</td>
                                    <td class="${classValueA}">${data.qtRefAffectedA}</td>
                                    <td class="${classValueB}">${data.qtRefAffectedB}</td>
                                </tr>
                                <tr>
                                    <td class="${classLabel}" colspan="1">Line Affected</td>
                                    <td class="${classValueSpan}" colspan="2">${data.qtLineAffected}</td>
                                </tr>
                                <tr>
                                    <td class="${classLabel}" colspan="1">Work Order Affected</td>
                                    <td class="${classValueSpan}" colspan="2">${data.qtWoAffected}</td>
                                </tr>
                                <tr>
                                    <td class="${classLabel}" colspan="1">Work Order QTY</td>
                                    <td class="${classValueSpan}" colspan="2">${data.qtWoQty}</td>
                                </tr>
                                <tr>
                                    <td class="${classLabel}" colspan="1">Date / Shift</td>
                                    <td class="${classValueSpan}" colspan="2">${data.qtDateShift}</td>
                                </tr>
                                <!-- Secțiunea 2: Test Inspection AOI (WO) -->
                                <tr>
                                    <td rowspan="2" class="${classSectionAOI}">Test Inspection AOI</td>
                                    <td class="${classLabel}" colspan="1">False Call on AOI / GSF ?</td>
                                    <td class="${classValueSpan}" colspan="2">${data.aoiFalseCall}</td>
                                </tr>
                                <tr>
                                    <td class="${classLabel}" colspan="1">IF YES - Link To Photos</td>
                                    <td class="${classValueSpan}" colspan="2">${data.aoiPhotos}</td>
                                </tr>
                                <!-- Secțiunea 3: Test Debug (WO) -->
                                <tr>
                                    <td class="${classSectionTD}">Test Debug - ICT / Functional Test</td>
                                    <td class="${classLabel}" colspan="1">We have Coverage on affected References?</td>
                                    <td class="${classValueSpan}" colspan="2">${data.tdCoverage}</td>
                                </tr>
                                <!-- Secțiunea 4: Containment Production / CFT (WO) -->
                                <tr>
                                    <td rowspan="4" class="${classSectionCFT}">Containment Production / CFT</td>
                                    <td class="${classLabel}" colspan="1">Common Process (WIP)</td>
                                    <td class="${classValueSpan}" colspan="2">${data.cftCommonProcess}</td>
                                </tr>
                                <tr>
                                    <td class="${classLabel}" colspan="1">CFT Line (MPF)</td>
                                    <td class="${classValueSpan}" colspan="2">${data.cftLine}</td>
                                </tr>
                                <tr>
                                    <td class="${classLabel}" colspan="1">Total QTY Affected</td>
                                    <td class="${classValueSpan}" colspan="2">${data.cftTotalQty}</td>
                                </tr>
                                <tr>
                                    <td class="${classLabel}" colspan="1">All Affected (S/N) Serial Numbers Was Sent To Fix?</td>
                                    <td class="${classValueSpan}" colspan="2">${data.cftAllAffectedSN}</td>
                                </tr>
                                <!-- v35.0: Nueva Secțiunea 5: Process Tech (WO) -->
                                <tr>
                                    <td class="${classSectionPT}">Process Tech / Engineering</td>
                                    <td class="${classLabel}" colspan="1">Check Pick-Up Orientation Was Set on Siplace?</td>
                                    <td class="${classValueSpan}" colspan="2">${data.ptCheckOrientation}</td>
                                </tr>
                                <!-- Secțiunea 6: Root Cause (WO) -->
                                <tr>
                                    <td class="${classSectionRC}">Root Cause</td>
                                    <td colspan="3" class="${classValueMulti}">${data.rootCause}</td>
                                </tr>
                                <!-- Secțiunea 7: Corrective Actions (WO) -->
                                <tr>
                                    <td class="${classSectionCA}">Corrective Actions</td>
                                    <td colspan="3" class="${classValueMulti}">${data.correctiveActions}</td>
                                </tr>
                            </tbody>
                        </table>`;

                    tableOutput.innerHTML = tableWebHTML; 
                    outputContainer.style.display = 'block';
                    outputContainer.scrollIntoView({ behavior: 'smooth' });
                });

                copyBtn.addEventListener('click', () => {
                    try {
                        const range = document.createRange();
                        range.selectNode(tableOutput); 
                        window.getSelection().removeAllRanges();
                        window.getSelection().addRange(range);
                        if (!document.execCommand('copy')) throw new Error('execCommand falló');
                        copyNotification.textContent = 'Copiata!';
                        copyNotification.style.backgroundColor = '#22c55e';
                        copyNotification.style.opacity = '1';
                        setTimeout(() => copyNotification.style.opacity = '0', 2000);
                    } catch (err) {
                        copyNotification.textContent = 'Eroare la copiere';
                        copyNotification.style.backgroundColor = '#ef4444';
                        copyNotification.style.opacity = '1';
                        setTimeout(() => copyNotification.style.opacity = '0', 3000);
                    } finally {
                        window.getSelection().removeAllRanges();
                    }
                });
            }
            // --- FIN: Lógica para Formulario 3 (Wrong Orientation) ---

            // --- INICIO: Lógica para Formulario 4 (MSL Expirat) ---
            function setupFormMSL() {
                const form = document.getElementById('data-form-msl');
                if (!form) return;
                const outputContainer = document.getElementById('output-container-msl');
                const copyBtn = document.getElementById('copy-btn-msl');
                const copyNotification = document.getElementById('copy-notification-msl');
                const tableOutput = document.getElementById('table-output-msl');
                const errorDiv = document.getElementById('error-notification-msl');

                const sideAffectedSelect = document.getElementById('msl_qtSideAffected');
                const usageSideA = document.getElementById('msl_qtUsageSideA');
                const usageSideB = document.getElementById('msl_qtUsageSideB');
                const refAffectedA = document.getElementById('msl_qtRefAffectedA');
                const refAffectedB = document.getElementById('msl_qtRefAffectedB');

                sideAffectedSelect.addEventListener('change', (e) => {
                    const selection = e.target.value;
                    const fields = [usageSideA, usageSideB, refAffectedA, refAffectedB];
                    fields.forEach(field => {
                        field.disabled = false;
                        field.required = true;
                        field.value = '';
                    });
                    if (selection === 'A') {
                        [usageSideB, refAffectedB].forEach(f => { f.value = 'N/A'; f.disabled = true; f.required = false; });
                    } else if (selection === 'B') {
                        [usageSideA, refAffectedA].forEach(f => { f.value = 'N/A'; f.disabled = true; f.required = false; });
                    }
                });

                form.addEventListener('submit', (e) => {
                    e.preventDefault();
                    if (!form.checkValidity()) {
                        let firstInvalidField = form.querySelector(':invalid');
                        let labelText = 'un câmp';
                        if(firstInvalidField) {
                             let label = document.querySelector(`label[for='${firstInvalidField.id}']`);
                             if(label) labelText = label.firstChild.textContent.trim();
                        }
                        errorDiv.textContent = `Vă rugăm să completați câmpul obligatoriu: "${labelText}".`;
                        errorDiv.classList.remove('hidden');
                        if(firstInvalidField) firstInvalidField.focus();
                        errorDiv.scrollIntoView({ behavior: 'smooth', block: 'center' });
                        return;
                    }
                    errorDiv.classList.add('hidden');

                    const data = {
                        mslType: document.getElementById('msl_type').value || '&nbsp;',
                        totalHours: document.getElementById('msl_totalHours').value || '&nbsp;',
                        timeExpired: document.getElementById('msl_timeExpired').value || '&nbsp;',
                        timeFound: document.getElementById('msl_timeFound').value || '&nbsp;',
                        lineAffected: document.getElementById('msl_lineAffected').value || '&nbsp;',
                        modelPart: document.getElementById('msl_modelPart').value || '&nbsp;',
                        workOrder: document.getElementById('msl_workOrder').value || '&nbsp;',
                        componentPart: document.getElementById('msl_componentPart').value || '&nbsp;',
                        mpnPart: document.getElementById('msl_mpnPart').value || '&nbsp;',
                        licensePlate: document.getElementById('msl_licensePlate').value || '&nbsp;',
                        qtyLp: document.getElementById('msl_qtyLp').value || '&nbsp;',
                        qtUsageSideA: document.getElementById('msl_qtUsageSideA').value || '&nbsp;',
                        qtUsageSideB: document.getElementById('msl_qtUsageSideB').value || '&nbsp;',
                        qtRefAffectedA: document.getElementById('msl_qtRefAffectedA').value || '&nbsp;',
                        qtRefAffectedB: document.getElementById('msl_qtRefAffectedB').value || '&nbsp;',
                        qtyPcba: document.getElementById('msl_qtyPcba').value || '&nbsp;',
                        greenCard: document.getElementById('msl_greenCard').value || '&nbsp;',
                        formReport: document.getElementById('msl_formReport').value || '&nbsp;',
                        containment: document.getElementById('msl_containment').value.replace(/\n/g, '<br>') || '&nbsp;',
                        rootCause: document.getElementById('msl_rootCause').value.replace(/\n/g, '<br>') || '&nbsp;',
                        correctiveActions: document.getElementById('msl_correctiveActions').value.replace(/\n/g, '<br>') || '&nbsp;'
                    };

                    // v37.0: Definición de clases para la tabla MSL (3 columnas) - Colores actualizados
                    const baseCell = "p-2 border border-gray-300 align-middle text-center";
                    const baseLabel = `${baseCell} bg-gray-50 text-gray-700 font-medium`;
                    const baseValue = `${baseCell} text-gray-900 break-words`;
                    const classHeader = "p-3 bg-yellow-200 text-yellow-900 font-bold text-center text-base border border-gray-300";
                    
                    // Colores "crema" más suaves
                    const classLabelYellow = `${baseLabel} bg-yellow-100 text-yellow-900 font-semibold w-[30%]`;
                    const classLabelOrange = `${baseLabel} bg-orange-100 text-orange-800 font-semibold w-[30%]`;
                    const classLabelGray = `${baseLabel} w-[30%]`; // Se mantiene bg-gray-50

                    const classValueSpan = `${baseValue}`; // Se expandirá con colspan
                    const classValueA = `${baseValue} w-[35%]`; 
                    const classValueB = `${baseValue} w-[35%]`; 
                    const classValueMulti = `${baseValue} align-top`; 

                    const tableWebHTML = `
                        <table class="text-xs" style="border-collapse: collapse; width: 87%; table-layout: fixed;">
                            <thead>
                                <tr><th colspan="3" class="${classHeader}">Expired MSL</th></tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td class="${classLabelYellow}">MSL Type</td>
                                    <td class="${classValueSpan}" colspan="2">${data.mslType}</td>
                                </tr>
                                <tr>
                                    <td class="${classLabelYellow}">Total Number of Hours</td>
                                    <td class="${classValueSpan}" colspan="2">${data.totalHours}</td>
                                </tr>
                                <tr>
                                    <td class="${classLabelYellow}">Date / Time when expired</td>
                                    <td class="${classValueSpan}" colspan="2">${data.timeExpired}</td>
                                </tr>
                                <tr>
                                    <td class="${classLabelYellow}">Date / Time when found on Line</td>
                                    <td class="${classValueSpan}" colspan="2">${data.timeFound}</td>
                                </tr>
                                <tr>
                                    <td class="${classLabelGray}">Line Affected</td>
                                    <td class="${classValueSpan}" colspan="2">${data.lineAffected}</td>
                                </tr>
                                <tr>
                                    <td class="${classLabelGray}">Model Part Number</td>
                                    <td class="${classValueSpan}" colspan="2">${data.modelPart}</td>
                                </tr>
                                <tr>
                                    <td class="${classLabelGray}">Work Order</td>
                                    <td class="${classValueSpan}" colspan="2">${data.workOrder}</td>
                                </tr>
                                <tr>
                                    <td class="${classLabelOrange}">Component Part Number Expired</td>
                                    <td class="${classValueSpan}" colspan="2">${data.componentPart}</td>
                                </tr>
                                <tr>
                                    <td class="${classLabelOrange}">MPN Part Number</td>
                                    <td class="${classValueSpan}" colspan="2">${data.mpnPart}</td>
                                </tr>
                                <tr>
                                    <td class="${classLabelOrange}">License Plate Expired (LP)</td>
                                    <td class="${classValueSpan}" colspan="2">${data.licensePlate}</td>
                                </tr>
                                <tr>
                                    <td class="${classLabelOrange}">QTY LP Expired</td>
                                    <td class="${classValueSpan}" colspan="2">${data.qtyLp}</td>
                                </tr>

                                <!-- Sección A/B -->
                                <tr>
                                    <td class="${classLabelOrange}">Side Affected (A/B)</td>
                                    <td class="${baseLabel} text-center font-bold">A</td>
                                    <td class="${baseLabel} text-center font-bold">B</td>
                                </tr>
                                <tr>
                                    <td class="${classLabelOrange}">Usage / Side</td>
                                    <td class="${classValueA}">${data.qtUsageSideA}</td>
                                    <td class="${classValueB}">${data.qtUsageSideB}</td>
                                </tr>
                                <tr>
                                    <td class="${classLabelOrange}">Reference Affected</td>
                                    <td class="${classValueA}">${data.qtRefAffectedA}</td>
                                    <td class="${classValueB}">${data.qtRefAffectedB}</td>
                                </tr>

                                <tr>
                                    <td class="${classLabelOrange}">QTY PCBA Affected</td>
                                    <td class="${classValueSpan}" colspan="2">${data.qtyPcba}</td>
                                </tr>
                                <tr>
                                    <td class="${classLabelGray}">Green Card (MSL Setup Indicator)</td>
                                    <td class="${classValueSpan}" colspan="2">${data.greenCard}</td>
                                </tr>
                                <tr>
                                    <td class="${classLabelGray}">Form. 13620-MSL Report</td>
                                    <td class="${classValueSpan}" colspan="2">${data.formReport}</td>
                                </tr>

                                <!-- Secciones de Texto Largo -->
                                <tr>
                                    <td class="${classLabelGray}">Containment / SMT Production</td>
                                    <td class="${classValueMulti}" colspan="2">${data.containment}</td>
                                </tr>
                                <tr>
                                    <td class="${classLabelGray}">Root Cause</td>
                                    <td class="${classValueMulti}" colspan="2">${data.rootCause}</td>
                                </tr>
                                <tr>
                                    <td class="${classLabelGray}">Corrective Actions</td>
                                    <td class="${classValueMulti}" colspan="2">${data.correctiveActions}</td>
                                </tr>
                            </tbody>
                        </table>`;

                    tableOutput.innerHTML = tableWebHTML; 
                    outputContainer.style.display = 'block';
                    outputContainer.scrollIntoView({ behavior: 'smooth' });
                });

                copyBtn.addEventListener('click', () => {
                    try {
                        const range = document.createRange();
                        range.selectNode(tableOutput); 
                        window.getSelection().removeAllRanges();
                        window.getSelection().addRange(range);
                        if (!document.execCommand('copy')) throw new Error('execCommand falló');
                        copyNotification.textContent = 'Copiata!';
                        copyNotification.style.backgroundColor = '#22c55e';
                        copyNotification.style.opacity = '1';
                        setTimeout(() => copyNotification.style.opacity = '0', 2000);
                    } catch (err) {
                        copyNotification.textContent = 'Eroare la copiere';
                        copyNotification.style.backgroundColor = '#ef4444';
                        copyNotification.style.opacity = '1';
                        setTimeout(() => copyNotification.style.opacity = '0', 3000);
                    } finally {
                        window.getSelection().removeAllRanges();
                    }
                });
            }
            // --- FIN: Lógica para Formulario 4 (MSL Expirat) ---


            // --- INICIO: Lógica para Formulario 5 (Wrong Process Soldering) ---
            function setupFormWPS() {
                const form = document.getElementById('data-form-wps');
                if (!form) return;
                const outputContainer = document.getElementById('output-container-wps');
                const copyBtn = document.getElementById('copy-btn-wps');
                const copyNotification = document.getElementById('copy-notification-wps');
                const tableOutput = document.getElementById('table-output-wps');
                const errorDiv = document.getElementById('error-notification-wps');

                const sideAffectedSelect = document.getElementById('wps_pdSideAffected');
                const usageSideA = document.getElementById('wps_pdUsageSideA');
                const usageSideB = document.getElementById('wps_pdUsageSideB');
                const refAffectedA = document.getElementById('wps_pdRefDesA');
                const refAffectedB = document.getElementById('wps_pdRefDesB');

                sideAffectedSelect.addEventListener('change', (e) => {
                    const selection = e.target.value;
                    const fields = [usageSideA, usageSideB, refAffectedA, refAffectedB];
                    fields.forEach(field => {
                        field.disabled = false;
                        field.required = true;
                        field.value = '';
                    });
                    if (selection === 'A') {
                        [usageSideB, refAffectedB].forEach(f => { f.value = 'N/A'; f.disabled = true; f.required = false; });
                    } else if (selection === 'B') {
                        [usageSideA, refAffectedA].forEach(f => { f.value = 'N/A'; f.disabled = true; f.required = false; });
                    }
                });

                form.addEventListener('submit', (e) => {
                    e.preventDefault();
                    if (!form.checkValidity()) {
                        let firstInvalidField = form.querySelector(':invalid');
                        let labelText = 'un câmp';
                        if(firstInvalidField) {
                             let label = document.querySelector(`label[for='${firstInvalidField.id}']`);
                             if(label) labelText = label.firstChild.textContent.trim();
                        }
                        errorDiv.textContent = `Vă rugăm să completați câmpul obligatoriu: "${labelText}".`;
                        errorDiv.classList.remove('hidden');
                        if(firstInvalidField) firstInvalidField.focus();
                        errorDiv.scrollIntoView({ behavior: 'smooth', block: 'center' });
                        return;
                    }
                    errorDiv.classList.add('hidden');

                    // v38.0: Recolectar datos del formulario WPS
                    const data = {
                        selectProcess: document.getElementById('wps_selectProcess').value || 'Defect',
                        pdPCBA_PN: document.getElementById('wps_pdPCBA_PN').value || '&nbsp;',
                        pdComponent_PN: document.getElementById('wps_pdComponent_PN').value || '&nbsp;',
                        pdUsageSideA: document.getElementById('wps_pdUsageSideA').value || '&nbsp;',
                        pdUsageSideB: document.getElementById('wps_pdUsageSideB').value || '&nbsp;',
                        pdRefDesA: document.getElementById('wps_pdRefDesA').value || '&nbsp;',
                        pdRefDesB: document.getElementById('wps_pdRefDesB').value || '&nbsp;',
                        pdLine: document.getElementById('wps_pdLine').value || '&nbsp;',
                        pdWorkOrder: document.getElementById('wps_pdWorkOrder').value || '&nbsp;',
                        pdWO_QTY: document.getElementById('wps_pdWO_QTY').value || '&nbsp;',
                        pdDateShift: document.getElementById('wps_pdDateShift').value || '&nbsp;',
                        contCommonProcess: document.getElementById('wps_contCommonProcess').value || '&nbsp;',
                        contCFTLine: document.getElementById('wps_contCFTLine').value || '&nbsp;',
                        contTotalQTY: document.getElementById('wps_contTotalQTY').value || '&nbsp;',
                        contAllAffectedSN: document.getElementById('wps_contAllAffectedSN').value || '&nbsp;',
                        xrayInProcess: document.getElementById('wps_xrayInProcess').value || '&nbsp;',
                        xrayResult: document.getElementById('wps_xrayResult').value || '&nbsp;',
                        tdCoverage: document.getElementById('wps_tdCoverage').value || '&nbsp;',
                        rootCause: document.getElementById('wps_rootCause').value.replace(/\n/g, '<br>') || '&nbsp;',
                        correctiveActions: document.getElementById('wps_correctiveActions').value.replace(/\n/g, '<br>') || '&nbsp;'
                    };

                    // v38.0: Definición de clases para la tabla WPS (4 columnas)
                    const baseCell = "p-2 border border-gray-300 align-middle text-center";
                    const baseLabel = `${baseCell} bg-gray-50 text-gray-700 font-medium`;
                    const baseValue = `${baseCell} text-gray-900 break-words`;
                    const classHeader = "p-3 bg-yellow-200 text-yellow-900 font-bold text-center text-base border border-gray-300";
                    
                    const classSectionPD = `${baseCell} bg-blue-100 text-blue-800 font-semibold w-[20%]`;
                    const classSectionCont = `${baseCell} bg-yellow-100 text-yellow-800 font-semibold`;
                    const classSectionXray = `${baseCell} bg-cyan-100 text-cyan-800 font-semibold`;
                    const classSectionTD = `${baseCell} bg-green-100 text-green-800 font-semibold`;
                    const classSectionRC = `${baseCell} bg-gray-200 text-gray-800 font-semibold`;
                    const classSectionCA = `${baseCell} bg-purple-100 text-purple-800 font-semibold`;

                    const classLabel = `${baseLabel} w-[21%]`;
                    const classValueSpan = `${baseValue}`; 
                    const classValueA = `${baseValue} w-[25%]`; 
                    const classValueB = `${baseValue} w-[25%]`; 
                    const classValueMulti = `${baseValue} align-top`; 

                    // v38.0: Generación de tabla para "Wrong Process Soldering"
                    const tableWebHTML = `
                        <table class="text-xs" style="border-collapse: collapse; width: 87%; table-layout: fixed;">
                            <thead>
                                <tr><th colspan="4" class="${classHeader}">Wrong Process - ${data.selectProcess}</th></tr>
                            </thead>
                            <tbody>
                                <!-- Secțiunea 1: Problem Description -->
                                <tr>
                                    <td rowspan="9" class="${classSectionPD}">Problem Description</td>
                                    <td class="${classLabel}" colspan="1">PCBA Part Number</td>
                                    <td class="${classValueSpan}" colspan="2">${data.pdPCBA_PN}</td>
                                </tr>
                                <tr>
                                    <td class="${classLabel}" colspan="1">Component Part Number</td>
                                    <td class="${classValueSpan}" colspan="2">${data.pdComponent_PN}</td>
                                </tr>
                                <tr>
                                    <td class="${classLabel}">Side (A/B)</td>
                                    <td class="${baseLabel} text-center font-bold">A</td>
                                    <td class="${baseLabel} text-center font-bold">B</td>
                                </tr>
                                <tr>
                                    <td class="${classLabel}">Usage / Side</td>
                                    <td class="${classValueA}">${data.pdUsageSideA}</td>
                                    <td class="${classValueB}">${data.pdUsageSideB}</td>
                                </tr>
                                <tr>
                                    <td class="${classLabel}">Ref. des.</td>
                                    <td class="${classValueA}">${data.pdRefDesA}</td>
                                    <td class="${classValueB}">${data.pdRefDesB}</td>
                                </tr>
                                <tr>
                                    <td class="${classLabel}" colspan="1">Line</td>
                                    <td class="${classValueSpan}" colspan="2">${data.pdLine}</td>
                                </tr>
                                <tr>
                                    <td class="${classLabel}" colspan="1">Work Order</td>
                                    <td class="${classValueSpan}" colspan="2">${data.pdWorkOrder}</td>
                                </tr>
                                <tr>
                                    <td class="${classLabel}" colspan="1">WO QTY</td>
                                    <td class="${classValueSpan}" colspan="2">${data.pdWO_QTY}</td>
                                </tr>
                                <tr>
                                    <td class="${classLabel}" colspan="1">Date / Shift</td>
                                    <td class="${classValueSpan}" colspan="2">${data.pdDateShift}</td>
                                </tr>
                                <!-- Secțiunea 2: Containment -->
                                <tr>
                                    <td rowspan="4" class="${classSectionCont}">Containment</td>
                                    <td class="${classLabel}" colspan="1">Common processes (WIP)</td>
                                    <td class="${classValueSpan}" colspan="2">${data.contCommonProcess}</td>
                                </tr>
                                <tr>
                                    <td class="${classLabel}" colspan="1">CFT line (MPF)</td>
                                    <td class="${classValueSpan}" colspan="2">${data.contCFTLine}</td>
                                </tr>
                                 <tr>
                                    <td class="${classLabel}" colspan="1">Total affected QTY</td>
                                    <td class="${classValueSpan}" colspan="2">${data.contTotalQTY}</td>
                                </tr>
                                <tr>
                                    <td class="${classLabel}" colspan="1">All affected S/N was sent to Fix?</td>
                                    <td class="${classValueSpan}" colspan="2">${data.contAllAffectedSN}</td>
                                </tr>
                                <!-- Secțiunea 3: X-ray -->
                                <tr>
                                    <td rowspan="2" class="${classSectionXray}">X-ray</td>
                                    <td class="${classLabel}" colspan="1">X-ray manual/automat in process flow?</td>
                                    <td class="${classValueSpan}" colspan="2">${data.xrayInProcess}</td>
                                </tr>
                                <tr>
                                    <td class="${classLabel}" colspan="1">X-ray result</td>
                                    <td class="${classValueSpan}" colspan="2">${data.xrayResult}</td>
                                </tr>
                                <!-- Secțiunea 4: Test Debug -->
                                <tr>
                                    <td class="${classSectionTD}">Test Debug - ICT / Functional Test</td>
                                    <td class="${classLabel}" colspan="1">We have coverage on affected references?</td>
                                    <td class="${classValueSpan}" colspan="2">${data.tdCoverage}</td>
                                </tr>
                                <!-- Secțiunea 5: Root Cause -->
                                <tr>
                                    <td class="${classSectionRC}">Root Cause</td>
                                    <td colspan="3" class="${classValueMulti}">${data.rootCause}</td>
                                </tr>
                                <!-- Secțiunea 6: Corrective Actions -->
                                <tr>
                                    <td class="${classSectionCA}">Corrective Actions</td>
                                    <td colspan="3" class="${classValueMulti}">${data.correctiveActions}</td>
                                </tr>
                            </tbody>
                        </table>`;

                    tableOutput.innerHTML = tableWebHTML; 
                    outputContainer.style.display = 'block';
                    outputContainer.scrollIntoView({ behavior: 'smooth' });
                });

                copyBtn.addEventListener('click', () => {
                    try {
                        const range = document.createRange();
                        range.selectNode(tableOutput); 
                        window.getSelection().removeAllRanges();
                        window.getSelection().addRange(range);
                        if (!document.execCommand('copy')) throw new Error('execCommand falló');
                        copyNotification.textContent = 'Copiata!';
                        copyNotification.style.backgroundColor = '#22c55e';
                        copyNotification.style.opacity = '1';
                        setTimeout(() => copyNotification.style.opacity = '0', 2000);
                    } catch (err) {
                        copyNotification.textContent = 'Eroare la copiere';
                        copyNotification.style.backgroundColor = '#ef4444';
                        copyNotification.style.opacity = '1';
                        setTimeout(() => copyNotification.style.opacity = '0', 3000);
                    } finally {
                        window.getSelection().removeAllRanges();
                    }
                });
            }
            // --- FIN: Lógica para Formulario 5 (Wrong Process Soldering) ---

// --- INICIO: Lógica para Formulario 6 (Insertion Defects) - v43.0 ACTUALIZADA ---
            function setupFormID() {
                const form = document.getElementById('data-form-id');
                if (!form) return;
                const outputContainer = document.getElementById('output-container-id');
                const copyBtn = document.getElementById('copy-btn-id');
                const copyNotification = document.getElementById('copy-notification-id');
                const tableOutput = document.getElementById('table-output-id');
                const errorDiv = document.getElementById('error-notification-id');

                const sideAffectedSelect = document.getElementById('id_pdSideAffected');
                const usageSideA = document.getElementById('id_pdUsageSideA');
                const usageSideB = document.getElementById('id_pdUsageSideB');
                const refAffectedA = document.getElementById('id_pdRefDesA');
                const refAffectedB = document.getElementById('id_pdRefDesB');

                sideAffectedSelect.addEventListener('change', (e) => {
                    const selection = e.target.value;
                    const fields = [usageSideA, usageSideB, refAffectedA, refAffectedB];
                    fields.forEach(field => {
                        field.disabled = false;
                        field.required = true;
                        field.value = '';
                    });
                    if (selection === 'A') {
                        [usageSideB, refAffectedB].forEach(f => { f.value = 'N/A'; f.disabled = true; f.required = false; });
                    } else if (selection === 'B') {
                        [usageSideA, refAffectedA].forEach(f => { f.value = 'N/A'; f.disabled = true; f.required = false; });
                    }
                });

                form.addEventListener('submit', (e) => {
                    e.preventDefault();
                    if (!form.checkValidity()) {
                        let firstInvalidField = form.querySelector(':invalid');
                        let labelText = 'un câmp';
                        if(firstInvalidField) {
                             let label = document.querySelector(`label[for='${firstInvalidField.id}']`);
                             if(label) labelText = label.firstChild.textContent.trim();
                        }
                        errorDiv.textContent = `Vă rugăm să completați câmpul obligatoriu: "${labelText}".`;
                        errorDiv.classList.remove('hidden');
                        if(firstInvalidField) firstInvalidField.focus();
                        errorDiv.scrollIntoView({ behavior: 'smooth', block: 'center' });
                        return;
                    }
                    errorDiv.classList.add('hidden');

                    // v43.0: Recolectar datos del formulario ID actualizado
                    const data = {
                        selectProcess: document.getElementById('id_selectDefect').value || 'Defect',
                        pdPCBA_PN: document.getElementById('id_pdPCBA_PN').value || '&nbsp;',
                        pdComponent_PN: document.getElementById('id_pdComponent_PN').value || '&nbsp;',
                        pdUsageSideA: document.getElementById('id_pdUsageSideA').value || '&nbsp;',
                        pdUsageSideB: document.getElementById('id_pdUsageSideB').value || '&nbsp;',
                        pdRefDesA: document.getElementById('id_pdRefDesA').value || '&nbsp;',
                        pdRefDesB: document.getElementById('id_pdRefDesB').value || '&nbsp;',
                        pdLine: document.getElementById('id_pdLine').value || '&nbsp;',
                        pdWorkOrder: document.getElementById('id_pdWorkOrder').value || '&nbsp;',
                        pdWO_QTY: document.getElementById('id_pdWO_QTY').value || '&nbsp;',
                        pdDateShift: document.getElementById('id_pdDateShift').value || '&nbsp;',
                        contCommonProcess: document.getElementById('id_contCommonProcess').value || '&nbsp;',
                        contCFTLine: document.getElementById('id_contCFTLine').value || '&nbsp;',
                        contTotalQTY: document.getElementById('id_contTotalQTY').value || '&nbsp;',
                        contAllAffectedSN: document.getElementById('id_contAllAffectedSN').value || '&nbsp;',
                        // v43.0: Datos de AAD (reemplaza X-ray)
                        aadFalseCall: document.getElementById('id_aadFalseCall').value || '&nbsp;',
                        aadPhotos: document.getElementById('id_aadPhotos').value || '&nbsp;',
                        tdCoverage: document.getElementById('id_tdCoverage').value || '&nbsp;',
                        // v43.0: Datos de Setup Verification (nuevo)
                        svVerification: document.getElementById('id_svVerification').value || '&nbsp;',
                        rootCause: document.getElementById('id_rootCause').value.replace(/\n/g, '<br>') || '&nbsp;',
                        correctiveActions: document.getElementById('id_correctiveActions').value.replace(/\n/g, '<br>') || '&nbsp;'
                    };

                    // v43.0: Definición de clases para la tabla ID (4 columnas)
                    const baseCell = "p-2 border border-gray-300 align-middle text-center";
                    const baseLabel = `${baseCell} bg-gray-50 text-gray-700 font-medium`;
                    const baseValue = `${baseCell} text-gray-900 break-words`;
                    const classHeader = "p-3 bg-yellow-200 text-yellow-900 font-bold text-center text-base border border-gray-300";
                    
                    const classSectionPD = `${baseCell} bg-blue-100 text-blue-800 font-semibold w-[20%]`;
                    const classSectionCont = `${baseCell} bg-yellow-100 text-yellow-800 font-semibold`;
                    const classSectionAAD = `${baseCell} bg-cyan-100 text-cyan-800 font-semibold`; // v43.0: Renombrada de Xray
                    const classSectionTD = `${baseCell} bg-green-100 text-green-800 font-semibold`;
                    const classSectionSV = `${baseCell} bg-orange-100 text-orange-800 font-semibold`; // v43.0: Nueva
                    const classSectionRC = `${baseCell} bg-gray-200 text-gray-800 font-semibold`;
                    const classSectionCA = `${baseCell} bg-purple-100 text-purple-800 font-semibold`;

                    const classLabel = `${baseLabel} w-[21%]`;
                    const classValueSpan = `${baseValue}`; 
                    const classValueA = `${baseValue} w-[25%]`; 
                    const classValueB = `${baseValue} w-[25%]`; 
                    const classValueMulti = `${baseValue} align-top`; 

                    // v43.0: Generación de tabla actualizada para "Insertion Defects"
                    const tableWebHTML = `
                        <table class="text-xs" style="border-collapse: collapse; width: 87%; table-layout: fixed;">
                            <thead>
                                <tr><th colspan="4" class="${classHeader}">Insertion Defect - ${data.selectProcess}</th></tr>
                            </thead>
                            <tbody>
                                <!-- Secțiunea 1: Problem Description -->
                                <tr>
                                    <td rowspan="9" class="${classSectionPD}">Problem Description</td>
                                    <td class="${classLabel}" colspan="1">PCBA Part Number</td>
                                    <td class="${classValueSpan}" colspan="2">${data.pdPCBA_PN}</td>
                                </tr>
                                <tr>
                                    <td class="${classLabel}" colspan="1">Component Part Number</td>
                                    <td class="${classValueSpan}" colspan="2">${data.pdComponent_PN}</td>
                                </tr>
                                <tr>
                                    <td class="${classLabel}">Side (A/B)</td>
                                    <td class="${baseLabel} text-center font-bold">A</td>
                                    <td class="${baseLabel} text-center font-bold">B</td>
                                </tr>
                                <tr>
                                    <td class="${classLabel}">Usage / Side</td>
                                    <td class="${classValueA}">${data.pdUsageSideA}</td>
                                    <td class="${classValueB}">${data.pdUsageSideB}</td>
                                </tr>
                                <tr>
                                    <td class="${classLabel}">Ref. des.</td>
                                    <td class="${classValueA}">${data.pdRefDesA}</td>
                                    <td class="${classValueB}">${data.pdRefDesB}</td>
                                </tr>
                                <tr>
                                    <td class="${classLabel}" colspan="1">Line</td>
                                    <td class="${classValueSpan}" colspan="2">${data.pdLine}</td>
                                </tr>
                                <tr>
                                    <td class="${classLabel}" colspan="1">Work Order</td>
                                    <td class="${classValueSpan}" colspan="2">${data.pdWorkOrder}</td>
                                </tr>
                                <tr>
                                    <td class="${classLabel}" colspan="1">WO QTY</td>
                                    <td class="${classValueSpan}" colspan="2">${data.pdWO_QTY}</td>
                                </tr>
                                <tr>
                                    <td class="${classLabel}" colspan="1">Date / Shift</td>
                                    <td class="${classValueSpan}" colspan="2">${data.pdDateShift}</td>
                                </tr>
                                <!-- Secțiunea 2: Containment -->
                                <tr>
                                    <td rowspan="4" class="${classSectionCont}">Containment</td>
                                    <td class="${classLabel}" colspan="1">Common processes (WIP)</td>
                                    <td class="${classValueSpan}" colspan="2">${data.contCommonProcess}</td>
                                </tr>
                                <tr>
                                    <td class="${classLabel}" colspan="1">CFT line (MPF)</td>
                                    <td class="${classValueSpan}" colspan="2">${data.contCFTLine}</td>
                                </tr>
                                 <tr>
                                    <td class="${classLabel}" colspan="1">Total affected QTY</td>
                                    <td class="${classValueSpan}" colspan="2">${data.contTotalQTY}</td>
                                </tr>
                                <tr>
                                    <td class="${classLabel}" colspan="1">All affected S/N was sent to Fix?</td>
                                    <td class="${classValueSpan}" colspan="2">${data.contAllAffectedSN}</td>
                                </tr>
                                <!-- v43.0: Secțiunea 3: Test Inspection AAD -->
                                <tr>
                                    <td rowspan="2" class="${classSectionAAD}">Test Inspection AAD</td>
                                    <td class="${classLabel}" colspan="1">False Call on AAD?</td>
                                    <td class="${classValueSpan}" colspan="2">${data.aadFalseCall}</td>
                                </tr>
                                <tr>
                                    <td class="${classLabel}" colspan="1">IF YES - Link To Photos</td>
                                    <td class="${classValueSpan}" colspan="2">${data.aadPhotos}</td>
                                </tr>
                                <!-- Secțiunea 4: Test Debug (sin cambios) -->
                                <tr>
                                    <td class="${classSectionTD}">Test Debug - ICT / Functional Test</td>
                                    <td class="${classLabel}" colspan="1">We have coverage on affected references?</td>
                                    <td class="${classValueSpan}" colspan="2">${data.tdCoverage}</td>
                                </tr>
                                <!-- v43.0: Secțiunea 5: Setup Verification (Nueva) -->
                                <tr>
                                    <td class="${classSectionSV}">Setup Verification</td>
                                    <td class="${classLabel}" colspan="1">Affected Component P/N Verification</td>
                                    <td class="${classValueSpan}" colspan="2">${data.svVerification}</td>
                                </tr>
                                <!-- v43.0: Secțiunea 6: Root Cause (Re-numerada) -->
                                <tr>
                                    <td class="${classSectionRC}">Root Cause</td>
                                    <td colspan="3" class="${classValueMulti}">${data.rootCause}</td>
                                </tr>
                                <!-- v43.0: Secțiunea 7: Corrective Actions (Re-numerada) -->
                                <tr>
                                    <td class="${classSectionCA}">Corrective Actions</td>
                                    <td colspan="3" class="${classValueMulti}">${data.correctiveActions}</td>
                                </tr>
                            </tbody>
                        </table>`;

                    tableOutput.innerHTML = tableWebHTML; 
                    outputContainer.style.display = 'block';
                    outputContainer.scrollIntoView({ behavior: 'smooth' });
                });

                copyBtn.addEventListener('click', () => {
                    try {
                        const range = document.createRange();
                        range.selectNode(tableOutput); 
                        window.getSelection().removeAllRanges();
                        window.getSelection().addRange(range);
                        if (!document.execCommand('copy')) throw new Error('execCommand falló');
                        copyNotification.textContent = 'Copiata!';
                        copyNotification.style.backgroundColor = '#22c55e';
                        copyNotification.style.opacity = '1';
                        setTimeout(() => copyNotification.style.opacity = '0', 2000);
                    } catch (err) {
                        copyNotification.textContent = 'Eroare la copiere';
                        copyNotification.style.backgroundColor = '#ef4444';
                        copyNotification.style.opacity = '1';
                        setTimeout(() => copyNotification.style.opacity = '0', 3000);
                    } finally {
                        window.getSelection().removeAllRanges();
                    }
                });
            }
            // --- FIN: Lógica para Formulario 6 (Insertion Defects) ---


// --- INICIO: Lógica para Formulario 6 (Conformal Defects) - v43.0 ACTUALIZADA ---
            function setupFormCD() {
                const form = document.getElementById('data-form-cd');
                if (!form) return;
                const outputContainer = document.getElementById('output-container-cd');
                const copyBtn = document.getElementById('copy-btn-cd');
                const copyNotification = document.getElementById('copy-notification-cd');
                const tableOutput = document.getElementById('table-output-cd');
                const errorDiv = document.getElementById('error-notification-cd');

                const sideAffectedSelect = document.getElementById('cd_pdSideAffected');
                const usageSideA = document.getElementById('cd_pdUsageSideA');
                const usageSideB = document.getElementById('cd_pdUsageSideB');
                const refAffectedA = document.getElementById('cd_pdRefDesA');
                const refAffectedB = document.getElementById('cd_pdRefDesB');

                sideAffectedSelect.addEventListener('change', (e) => {
                    const selection = e.target.value;
                    const fields = [usageSideA, usageSideB, refAffectedA, refAffectedB];
                    fields.forEach(field => {
                        field.disabled = false;
                        field.required = true;
                        field.value = '';
                    });
                    if (selection === 'A') {
                        [usageSideB, refAffectedB].forEach(f => { f.value = 'N/A'; f.disabled = true; f.required = false; });
                    } else if (selection === 'B') {
                        [usageSideA, refAffectedA].forEach(f => { f.value = 'N/A'; f.disabled = true; f.required = false; });
                    }
                });

                form.addEventListener('submit', (e) => {
                    e.preventDefault();
                    if (!form.checkValidity()) {
                        let firstInvalidField = form.querySelector(':invalid');
                        let labelText = 'un câmp';
                        if(firstInvalidField) {
                             let label = document.querySelector(`label[for='${firstInvalidField.id}']`);
                             if(label) labelText = label.firstChild.textContent.trim();
                        }
                        errorDiv.textContent = `Vă rugăm să completați câmpul obligatoriu: "${labelText}".`;
                        errorDiv.classList.remove('hidden');
                        if(firstInvalidField) firstInvalidField.focus();
                        errorDiv.scrollIntoView({ behavior: 'smooth', block: 'center' });
                        return;
                    }
                    errorDiv.classList.add('hidden');

                    // v43.0: Recolectar datos del formulario ID actualizado
                    const data = {
                        selectProcess: document.getElementById('cd_selectDefect').value || 'Defect',
                        pdPCBA_PN: document.getElementById('cd_pdPCBA_PN').value || '&nbsp;',
                        pdComponent_PN: document.getElementById('cd_pdComponent_PN').value || '&nbsp;',
                        pdUsageSideA: document.getElementById('cd_pdUsageSideA').value || '&nbsp;',
                        pdUsageSideB: document.getElementById('cd_pdUsageSideB').value || '&nbsp;',
                        pdRefDesA: document.getElementById('cd_pdRefDesA').value || '&nbsp;',
                        pdRefDesB: document.getElementById('cd_pdRefDesB').value || '&nbsp;',
                        pdLine: document.getElementById('cd_pdLine').value || '&nbsp;',
                        pdWorkOrder: document.getElementById('cd_pdWorkOrder').value || '&nbsp;',
                        pdWO_QTY: document.getElementById('cd_pdWO_QTY').value || '&nbsp;',
                        pdDateShift: document.getElementById('cd_pdDateShift').value || '&nbsp;',
                        contCommonProcess: document.getElementById('cd_contCommonProcess').value || '&nbsp;',
                        contCFTLine: document.getElementById('cd_contCFTLine').value || '&nbsp;',
                        contTotalQTY: document.getElementById('cd_contTotalQTY').value || '&nbsp;',
                        contAllAffectedSN: document.getElementById('cd_contAllAffectedSN').value || '&nbsp;',
                        rootCause: document.getElementById('cd_rootCause').value.replace(/\n/g, '<br>') || '&nbsp;',
                        correctiveActions: document.getElementById('cd_correctiveActions').value.replace(/\n/g, '<br>') || '&nbsp;'
                    };

                    // v43.0: Definición de clases para la tabla ID (4 columnas)
                    const baseCell = "p-2 border border-gray-300 align-middle text-center";
                    const baseLabel = `${baseCell} bg-gray-50 text-gray-700 font-medium`;
                    const baseValue = `${baseCell} text-gray-900 break-words`;
                    const classHeader = "p-3 bg-yellow-200 text-yellow-900 font-bold text-center text-base border border-gray-300";
                    
                    const classSectionPD = `${baseCell} bg-blue-100 text-blue-800 font-semibold w-[20%]`;
                    const classSectionCont = `${baseCell} bg-yellow-100 text-yellow-800 font-semibold`;
                    const classSectionRC = `${baseCell} bg-gray-200 text-gray-800 font-semibold`;
                    const classSectionCA = `${baseCell} bg-purple-100 text-purple-800 font-semibold`;

                    const classLabel = `${baseLabel} w-[21%]`;
                    const classValueSpan = `${baseValue}`; 
                    const classValueA = `${baseValue} w-[25%]`; 
                    const classValueB = `${baseValue} w-[25%]`; 
                    const classValueMulti = `${baseValue} align-top`; 

                    // v43.0: Generación de tabla actualizada para "Conformal Defects"
                    const tableWebHTML = `
                        <table class="text-xs" style="border-collapse: collapse; width: 87%; table-layout: fixed;">
                            <thead>
                                <tr><th colspan="4" class="${classHeader}">Conformal Defect - ${data.selectProcess}</th></tr>
                            </thead>
                            <tbody>
                                <!-- Secțiunea 1: Problem Description -->
                                <tr>
                                    <td rowspan="9" class="${classSectionPD}">Problem Description</td>
                                    <td class="${classLabel}" colspan="1">PCBA Part Number</td>
                                    <td class="${classValueSpan}" colspan="2">${data.pdPCBA_PN}</td>
                                </tr>
                                <tr>
                                    <td class="${classLabel}" colspan="1">Component Part Number</td>
                                    <td class="${classValueSpan}" colspan="2">${data.pdComponent_PN}</td>
                                </tr>
                                <tr>
                                    <td class="${classLabel}">Side (A/B)</td>
                                    <td class="${baseLabel} text-center font-bold">A</td>
                                    <td class="${baseLabel} text-center font-bold">B</td>
                                </tr>
                                <tr>
                                    <td class="${classLabel}">Usage / Side</td>
                                    <td class="${classValueA}">${data.pdUsageSideA}</td>
                                    <td class="${classValueB}">${data.pdUsageSideB}</td>
                                </tr>
                                <tr>
                                    <td class="${classLabel}">Ref. des.</td>
                                    <td class="${classValueA}">${data.pdRefDesA}</td>
                                    <td class="${classValueB}">${data.pdRefDesB}</td>
                                </tr>
                                <tr>
                                    <td class="${classLabel}" colspan="1">Line</td>
                                    <td class="${classValueSpan}" colspan="2">${data.pdLine}</td>
                                </tr>
                                <tr>
                                    <td class="${classLabel}" colspan="1">Work Order</td>
                                    <td class="${classValueSpan}" colspan="2">${data.pdWorkOrder}</td>
                                </tr>
                                <tr>
                                    <td class="${classLabel}" colspan="1">WO QTY</td>
                                    <td class="${classValueSpan}" colspan="2">${data.pdWO_QTY}</td>
                                </tr>
                                <tr>
                                    <td class="${classLabel}" colspan="1">Date / Shift</td>
                                    <td class="${classValueSpan}" colspan="2">${data.pdDateShift}</td>
                                </tr>
                                <!-- Secțiunea 2: Containment -->
                                <tr>
                                    <td rowspan="4" class="${classSectionCont}">Containment</td>
                                    <td class="${classLabel}" colspan="1">Common processes (WIP)</td>
                                    <td class="${classValueSpan}" colspan="2">${data.contCommonProcess}</td>
                                </tr>
                                <tr>
                                    <td class="${classLabel}" colspan="1">CFT line (MPF)</td>
                                    <td class="${classValueSpan}" colspan="2">${data.contCFTLine}</td>
                                </tr>
                                 <tr>
                                    <td class="${classLabel}" colspan="1">Total affected QTY</td>
                                    <td class="${classValueSpan}" colspan="2">${data.contTotalQTY}</td>
                                </tr>
                                <tr>
                                    <td class="${classLabel}" colspan="1">All affected S/N was sent to Fix?</td>
                                    <td class="${classValueSpan}" colspan="2">${data.contAllAffectedSN}</td>
                                </tr>
                               
                                <!-- v43.0: Secțiunea 6: Root Cause (Re-numerada) -->
                                <tr>
                                    <td class="${classSectionRC}">Root Cause</td>
                                    <td colspan="3" class="${classValueMulti}">${data.rootCause}</td>
                                </tr>
                                <!-- v43.0: Secțiunea 7: Corrective Actions (Re-numerada) -->
                                <tr>
                                    <td class="${classSectionCA}">Corrective Actions</td>
                                    <td colspan="3" class="${classValueMulti}">${data.correctiveActions}</td>
                                </tr>
                            </tbody>
                        </table>`;

                    tableOutput.innerHTML = tableWebHTML; 
                    outputContainer.style.display = 'block';
                    outputContainer.scrollIntoView({ behavior: 'smooth' });
                });

                copyBtn.addEventListener('click', () => {
                    try {
                        const range = document.createRange();
                        range.selectNode(tableOutput); 
                        window.getSelection().removeAllRanges();
                        window.getSelection().addRange(range);
                        if (!document.execCommand('copy')) throw new Error('execCommand falló');
                        copyNotification.textContent = 'Copiata!';
                        copyNotification.style.backgroundColor = '#22c55e';
                        copyNotification.style.opacity = '1';
                        setTimeout(() => copyNotification.style.opacity = '0', 2000);
                    } catch (err) {
                        copyNotification.textContent = 'Eroare la copiere';
                        copyNotification.style.backgroundColor = '#ef4444';
                        copyNotification.style.opacity = '1';
                        setTimeout(() => copyNotification.style.opacity = '0', 3000);
                    } finally {
                        window.getSelection().removeAllRanges();
                    }
                });
            }
            // --- FIN: Lógica para Formulario 6 (Conformal Defects) ---

// --- INICIO: Lógica para Formulario 7 (Poze) ---
        function setupFormPOZE() {
            const form = document.getElementById('data-form-poze');
            if (!form) return;
            
            const outputContainer = document.getElementById('output-container-poze');
            const copyBtn = document.getElementById('copy-btn-poze');
            const copyNotification = document.getElementById('copy-notification-poze');
            const tableOutput = document.getElementById('table-output-poze');
            const errorDiv = document.getElementById('error-notification-poze');
            
            // Elementos dinámicos para títulos
            const selectType = document.getElementById('poze_selectType');
            const formTitle = document.getElementById('form-title-poze');
            const tableTitle = document.getElementById('table-title-poze');

            // v45.0: Actualizar títulos dinámicamente al cambiar la selección
            selectType.addEventListener('change', () => {
                const selectedText = selectType.value || "Poze AOI / SPI / X-Ray / AAD";
                const title = `Formular: ${selectedText}`;
                formTitle.textContent = title;
            });

            form.addEventListener('submit', (e) => {
                e.preventDefault();
                // Validación (copiada de otros formularios)
                if (!form.checkValidity()) {
                    let firstInvalidField = form.querySelector(':invalid');
                    let labelText = 'un câmp';
                    if(firstInvalidField) {
                         let label = document.querySelector(`label[for='${firstInvalidField.id}']`);
                         if(label) labelText = label.firstChild.textContent.trim();
                    }
                    errorDiv.textContent = `Vă rugăm să completați câmpul obligatoriu: "${labelText}".`;
                    errorDiv.classList.remove('hidden');
                    if(firstInvalidField) firstInvalidField.focus();
                    errorDiv.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    return;
                }
                errorDiv.classList.add('hidden');

                // Recolectar datos del formulario Poze
                const data = {
                    selectType: document.getElementById('poze_selectType').value, // Campo dinámico
                    partNumber: document.getElementById('poze_partNumber').value || '&nbsp;',
                    workOrder: document.getElementById('poze_workOrder').value || '&nbsp;',
                    dateWorkOrder: document.getElementById('poze_dateWorkOrder').value || '&nbsp;',
                    serialNumber: document.getElementById('poze_serialNumber').value || '&nbsp;',
                    reference: document.getElementById('poze_reference').value || '&nbsp;',
                    side: document.getElementById('poze_side').value || '&nbsp;',
                    lineMachine: document.getElementById('poze_lineMachine').value || '&nbsp;',
                };

                // Actualizar el título de la tabla generada (dinámico)
                tableTitle.textContent = `Tabelul Generat (${data.selectType})`;

                // Definición de clases para la tabla Poze (2 columnas, estilo MSL)
                const baseCell = "p-2 border border-gray-300 align-middle";
                const classHeader = "p-3 bg-yellow-200 text-yellow-900 font-bold text-center text-base border border-gray-300";
                // Usamos un estilo de etiqueta simple de 2 columnas
                const classLabel = `${baseCell} bg-gray-100 text-gray-800 font-semibold text-center w-[30%]`;
                const classValue = `${baseCell} text-gray-900 text-center break-words`;

                // Generación de tabla para "Poze" (2 columnas)
                const tableWebHTML = `
                    <table class="text-xs" style="border-collapse: collapse; table-layout: fixed;">
                        <thead>
                            <!-- Título dinámico de la cabecera -->
                            <tr><th colspan="2" class="${classHeader}">${data.selectType} </th></tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td class="${classLabel}">Part Number</td>
                                <td class="${classValue}">${data.partNumber}</td>
                            </tr>
                            <tr>
                                <td class="${classLabel}">Work Order</td>
                                <td class="${classValue}">${data.workOrder}</td>
                            </tr>
                            <tr>
                                <td class="${classLabel}">Date work order</td>
                                <td class="${classValue}">${data.dateWorkOrder}</td>
                            </tr>
                            <tr>
                                <td class="${classLabel}">Serial Number</td>
                                <td class="${classValue}">${data.serialNumber}</td>
                            </tr>
			    <tr>
                                <td class="${classLabel}">Reference / References</td>
                                <td class="${classValue}">${data.reference}</td>
                            </tr>
                            <tr>
                                <td class="${classLabel}">Side</td>
                                <td class="${classValue}">${data.side}</td>
                            </tr>
                            <tr>
                                <td class="${classLabel}">Line/ EIN machine</td>
                                <td class="${classValue}">${data.lineMachine}</td>
                            </tr>
                        </tbody>
                    </table>`;

                tableOutput.innerHTML = tableWebHTML; 
                outputContainer.style.display = 'block';
                outputContainer.scrollIntoView({ behavior: 'smooth' });
            });

            // Lógica de copiado (exactamente igual que en MSL)
            copyBtn.addEventListener('click', () => {
                try {
                    const range = document.createRange();
                    range.selectNode(tableOutput); 
                    window.getSelection().removeAllRanges();
                    window.getSelection().addRange(range);
                    if (!document.execCommand('copy')) throw new Error('execCommand falló');
                    copyNotification.textContent = 'Copiata!';
                    copyNotification.style.backgroundColor = '#22c55e';
                    copyNotification.style.opacity = '1';
                    setTimeout(() => copyNotification.style.opacity = '0', 2000);
                } catch (err) {
                    copyNotification.textContent = 'Eroare la copiere';
                    copyNotification.style.backgroundColor = '#ef4444';
                    copyNotification.style.opacity = '1';
                    setTimeout(() => copyNotification.style.opacity = '0', 3000);
                } finally {
                    window.getSelection().removeAllRanges();
                }
            });
        }
        // --- FIN: Lógica para Formulario 7 (Poze) ---
        // =================================================================

// --- INICIO: Lógica para Formulario 8 (Capat de Rola) ---
        function setupFormCR() {
            const form = document.getElementById('data-form-cr');
            if (!form) return;
            
            const outputContainer = document.getElementById('output-container-cr');
            const copyBtn = document.getElementById('copy-btn-cr');
            const copyNotification = document.getElementById('copy-notification-cr');
            const tableOutput = document.getElementById('table-output-cr');
            const errorDiv = document.getElementById('error-notification-cr');
            
            // Título de la tabla generada (es estático, pero lo seleccionamos para confirmación)
            const tableTitle = document.getElementById('table-title-cr');
            tableTitle.textContent = 'Tabelul Generat (Capat de Rola)'; // Título estático

            form.addEventListener('submit', (e) => {
                e.preventDefault();
                // Validación (copiada de otros formularios)
                if (!form.checkValidity()) {
                    let firstInvalidField = form.querySelector(':invalid');
                    let labelText = 'un câmp';
                    if(firstInvalidField) {
                         let label = document.querySelector(`label[for='${firstInvalidField.id}']`);
                         if(label) labelText = label.firstChild.textContent.trim();
                    }
                    errorDiv.textContent = `Vă rugăm să completați câmpul obligatoriu: "${labelText}".`;
                    errorDiv.classList.remove('hidden');
                    if(firstInvalidField) firstInvalidField.focus();
                    errorDiv.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    return;
                }
                errorDiv.classList.add('hidden');

                // Recolectar datos del formulario Capat de Rola
                const data = {
                    problemStatement: document.getElementById('cr_problemStatement').value.replace(/\n/g, '<br>') || '&nbsp;',
                    pnPcba: document.getElementById('cr_pnPcba').value || '&nbsp;',
                    pnComponent: document.getElementById('cr_pnComponent').value || '&nbsp;',
                    mpnComponent: document.getElementById('cr_mpnComponent').value || '&nbsp;',
                    lp: document.getElementById('cr_lp').value || '&nbsp;',
                    qtyLp: document.getElementById('cr_qtyLp').value || '&nbsp;',
                    identificatLa: document.getElementById('cr_identificatLa').value || '&nbsp;',
                };

                // Definición de clases para la tabla CR (2 columnas, estilo Poze/MSL)
                const baseCell = "p-2 border border-gray-300 align-middle";
                const classHeader = "p-3 bg-yellow-200 text-yellow-900 font-bold text-center text-base border border-gray-300";
                const classLabel = `${baseCell} bg-gray-100 text-gray-800 font-semibold text-center w-[30%]`;
                const classValue = `${baseCell} text-gray-900 text-center break-words`;
                const classValueMulti = `${classValue} align-top`; // Para el textarea

                // Generación de tabla para "Capat de Rola" (2 columnas)
                const tableWebHTML = `
                    <table class="text-xs" style="border-collapse: collapse; table-layout: fixed;">
                        <thead>
                            <!-- Título estático de la cabecera -->
                            <tr><th colspan="2" class="${classHeader}">Capat de Rola cu P/N Gresit</th></tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td class="${classLabel}">Problem Statement</td>
                                <td class="${classValueMulti}">${data.problemStatement}</td>
                            </tr>
                            <tr>
                                <td class="${classLabel}">PN PCBA</td>
                                <td class="${classValue}">${data.pnPcba}</td>
                            </tr>
                            <tr>
                                <td class="${classLabel}">PN Component</td>
                                <td class="${classValue}">${data.pnComponent}</td>
                            </tr>
                            <tr>
                                <td class="${classLabel}">MPN Component</td>
                                <td class="${classValue}">${data.mpnComponent}</td>
                            </tr>
                            <tr>
                                <td class="${classLabel}">LP</td>
                                <td class="${classValue}">${data.lp}</td>
                            </tr>
                            <tr>
                                <td class="${classLabel}">Quantity of LP</td>
                                <td class="${classValue}">${data.qtyLp}</td>
                            </tr>
                            <tr>
                                <td class="${classLabel}">P/N gresit identificat la</td>
                                <td class="${classValue}">${data.identificatLa}</td>
                            </tr>
                        </tbody>
                    </table>`;

                tableOutput.innerHTML = tableWebHTML; 
                outputContainer.style.display = 'block';
                outputContainer.scrollIntoView({ behavior: 'smooth' });
            });

            // Lógica de copiado (exactamente igual que en Poze/MSL)
            copyBtn.addEventListener('click', () => {
                try {
                    const range = document.createRange();
                    range.selectNode(tableOutput); 
                    window.getSelection().removeAllRanges();
                    window.getSelection().addRange(range);
                    if (!document.execCommand('copy')) throw new Error('execCommand falló');
                    copyNotification.textContent = 'Copiata!';
                    copyNotification.style.backgroundColor = '#22c55e';
                    copyNotification.style.opacity = '1';
                    setTimeout(() => copyNotification.style.opacity = '0', 2000);
                } catch (err) {
                    copyNotification.textContent = 'Eroare la copiere';
                    copyNotification.style.backgroundColor = '#ef4444';
                    copyNotification.style.opacity = '1';
                    setTimeout(() => copyNotification.style.opacity = '0', 3000);
                } finally {
                    window.getSelection().removeAllRanges();
                }
            });
        }
        // --- FIN: Lógica para Formulario 8 (Capat de Rola) ---

// v50.0: COPIA Y PEGA ESTA NUEVA FUNCIÓN COMPLETA
        // =================================================================
        // --- INICIO: Lógica para Formulario 9 (Defecte Etichete) ---
        function setupFormDE() {
            const form = document.getElementById('data-form-de');
            if (!form) return;
            
            const outputContainer = document.getElementById('output-container-de');
            const copyBtn = document.getElementById('copy-btn-de');
            const copyNotification = document.getElementById('copy-notification-de');
            const tableOutput = document.getElementById('table-output-de');
            const errorDiv = document.getElementById('error-notification-de');
            
            const selectDefect = document.getElementById('de_selectDefect');
            const formTitle = document.getElementById('form-title-de');
            const tableTitle = document.getElementById('table-title-de');

            // Actualizar títulos dinámicamente
            selectDefect.addEventListener('change', () => {
                const selectedText = selectDefect.value || "Defecte Etichete";
                formTitle.textContent = `Formular: ${selectedText}`;
                tableTitle.textContent = `Tabelul Generat (${selectedText})`;
            });

            form.addEventListener('submit', (e) => {
                e.preventDefault();
                if (!form.checkValidity()) {
                    let firstInvalidField = form.querySelector(':invalid');
                    let labelText = 'un câmp';
                    if(firstInvalidField) {
                         let label = document.querySelector(`label[for='${firstInvalidField.id}']`);
                         if(label) labelText = label.firstChild.textContent.trim();
                    }
                    errorDiv.textContent = `Vă rugăm să completați câmpul obligatoriu: "${labelText}".`;
                    errorDiv.classList.remove('hidden');
                    if(firstInvalidField) firstInvalidField.focus();
                    errorDiv.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    return;
                }
                errorDiv.classList.add('hidden');

                // Recolectar datos del formulario Defecte Etichete
                const data = {
                    selectDefect: document.getElementById('de_selectDefect').value,
                    qtModelPart: document.getElementById('de_qtModelPart').value || '&nbsp;',
                    qtWoAffected: document.getElementById('de_qtWoAffected').value || '&nbsp;',
                    qtWoQty: document.getElementById('de_qtWoQty').value || '&nbsp;',
                    qtDateShift: document.getElementById('de_qtDateShift').value || '&nbsp;',
                    aoiLabelDefect: document.getElementById('de_aoiLabelDefect').value || '&nbsp;',
                    aoiPhotos: document.getElementById('de_aoiPhotos').value || '&nbsp;',
                    cftCommonProcess: document.getElementById('de_cftCommonProcess').value || '&nbsp;',
                    cftLine: document.getElementById('de_cftLine').value || '&nbsp;',
                    cftTotalQty: document.getElementById('de_cftTotalQty').value || '&nbsp;',
                    cftAllAffectedSN: document.getElementById('de_cftAllAffectedSN').value || '&nbsp;',
                    rcFormCompleted: document.getElementById('de_rcFormCompleted').value || '&nbsp;',
                    rcDetails: document.getElementById('de_rcDetails').value.replace(/\n/g, '<br>') || '&nbsp;',
                    correctiveActions: document.getElementById('de_correctiveActions').value.replace(/\n/g, '<br>') || '&nbsp;'
                };

                // Actualizar el título de la tabla (ya se hizo en el 'change' listener, pero reconfirmamos)
                tableTitle.textContent = `Tabelul Generat (${data.selectDefect})`;

                // Clases (copiadas de 'Wrong Process' - 4 columnas)
                const baseCell = "p-2 border border-gray-300 align-middle text-center";
                const baseLabel = `${baseCell} bg-gray-50 text-gray-700 font-medium`;
                const baseValue = `${baseCell} text-gray-900 break-words`;
                const classHeader = "p-3 bg-yellow-200 text-yellow-900 font-bold text-center text-base border border-gray-300";
                
                // Colores de sección
                const classSectionQT = `${baseCell} bg-blue-100 text-blue-800 font-semibold w-[20%]`;
                const classSectionAOI = `${baseCell} bg-cyan-100 text-cyan-800 font-semibold`;
                const classSectionCFT = `${baseCell} bg-yellow-100 text-yellow-800 font-semibold`;
                const classSectionRC = `${baseCell} bg-gray-200 text-gray-800 font-semibold`;
                const classSectionCA = `${baseCell} bg-purple-100 text-purple-800 font-semibold`;

                const classLabel = `${baseLabel} w-[21%]`;
                const classValueSpan = `${baseValue} colspan="2"`; // Valor merge
                const classValueMulti = `${baseValue} align-top text-left`; // Para textareas

                // Generación de tabla para "Defecte Etichete"
                const tableWebHTML = `
                    <table class="text-xs" style="border-collapse: collapse; width: 87%; table-layout: fixed;">
                        <thead>
                            <!-- Título dinámico de la cabecera -->
                            <tr><th colspan="4" class="${classHeader}">${data.selectDefect}</th></tr>
                        </thead>
                        <tbody>
                            <!-- Secțiunea 1: QT Technician -->
                            <tr>
                                <td rowspan="4" class="${classSectionQT}">QT Technician</td>
                                <td class="${classLabel}">Model Part Number</td>
                                <td class="${classValueSpan}" colspan="2">${data.qtModelPart}</td>
                            </tr>
                            <tr>
                                <td class="${classLabel}">Work Order Affected</td>
                                <td class="${classValueSpan}" colspan="2">${data.qtWoAffected}</td>
                            </tr>
                            <tr>
                                <td class="${classLabel}">Work Order QTY</td>
                                <td class="${classValueSpan}" colspan="2">${data.qtWoQty}</td>
                            </tr>
                            <tr>
                                <td class="${classLabel}">Date / Shift</td>
                                <td class="${classValueSpan}" colspan="2">${data.qtDateShift}</td>
                            </tr>
                            <!-- Secțiunea 2: Test Inspection AOI -->
                            <tr>
                                <td rowspan="2" class="${classSectionAOI}">Test Inspection AOI</td>
                                <td class="${classLabel}">Label Defect on AOI Photos ?</td>
                                <td class="${classValueSpan}" colspan="2">${data.aoiLabelDefect}</td>
                            </tr>
                            <tr>
                                <td class="${classLabel}">IF YES - Link To Photos</td>
                                <td class="${classValueSpan}" colspan="2">${data.aoiPhotos}</td>
                            </tr>
                            <!-- Secțiunea 3: Containment Production / CFT -->
                            <tr>
                                <td rowspan="4" class="${classSectionCFT}">Containment Production / CFT</td>
                                <td class="${classLabel}">Common Process (WIP)</td>
                                <td class="${classValueSpan}" colspan="2">${data.cftCommonProcess}</td>
                            </tr>
                            <tr>
                                <td class="${classLabel}">CFT Line (MPF)</td>
                                <td class="${classValueSpan}" colspan="2">${data.cftLine}</td>
                            </tr>
                            <tr>
                                <td class="${classLabel}">Total QTY Affected</td>
                                <td class="${classValueSpan}" colspan="2">${data.cftTotalQty}</td>
                            </tr>
                            <tr>
                                <td class="${classLabel}">All Affected (S/N) Serial Numbers Was Sent To Fix?</td>
                                <td class="${classValueSpan}" colspan="2">${data.cftAllAffectedSN}</td>
                            </tr>
                            <!-- Secțiunea 4: Root Cause -->
                            <tr>
                                <td rowspan="2" class="${classSectionRC}">Root Cause</td>
                                <td class="${classLabel}">Form #1461 or #1593-01 completed and Verified by QT?</td>
                                <td class="${classValueSpan}" colspan="2">${data.rcFormCompleted}</td>
                            </tr>
                            <tr>
                                <td colspan="3" class="${classValueMulti}">${data.rcDetails}</td>
                            </tr>
                            <!-- Secțiunea 5: Corrective Actions -->
                            <tr>
                                <td class="${classSectionCA}">Corrective Actions</td>
                                <td colspan="3" class="${classValueMulti}">${data.correctiveActions}</td>
                            </tr>
                        </tbody>
                    </table>`;

                tableOutput.innerHTML = tableWebHTML; 
                outputContainer.style.display = 'block';
                outputContainer.scrollIntoView({ behavior: 'smooth' });
            });

            // Lógica de copiado (exactamente igual que en otros formularios)
            copyBtn.addEventListener('click', () => {
                try {
                    const range = document.createRange();
                    range.selectNode(tableOutput); 
                    window.getSelection().removeAllRanges();
                    window.getSelection().addRange(range);
                    if (!document.execCommand('copy')) throw new Error('execCommand falló');
                    copyNotification.textContent = 'Copiata!';
                    copyNotification.style.backgroundColor = '#22c55e';
                    copyNotification.style.opacity = '1';
                    setTimeout(() => copyNotification.style.opacity = '0', 2000);
                } catch (err) {
                    copyNotification.textContent = 'Eroare la copiere';
                    copyNotification.style.backgroundColor = '#ef4444';
                    copyNotification.style.opacity = '1';
                    setTimeout(() => copyNotification.style.opacity = '0', 3000);
                } finally {
                    window.getSelection().removeAllRanges();
                }
            });
        }
        // --- FIN: Lógica para Formulario 9 (Defecte Etichete) ---
        // =================================================================


            // --- Inicializar los CINCO controladores de formulario ---
            setupFormWPN();
            setupFormWP();
            setupFormWO();
            setupFormMSL();
            setupFormWPS(); // v38.0: Añadido
	    setupFormID(); // v42.0: Añadido
            setupFormPOZE();
            setupFormCR();
            setupFormDE();
            setupFormCD();

        });
    </script>
    <!-- FIN DEL SCRIPT -->

</body>
</html>